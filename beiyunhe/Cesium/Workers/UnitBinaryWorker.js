define(["./createTaskProcessorWorker-03824364","./Resource-be841477","./Cartesian3-e96ac170","./HouseDrawer","./ParseBinaryData","./GetPrimitiveData","./defer-7878b392","./defaultValue-9f6a6288","./defined-64766648","./Math-56779564","./combine-ac72e009","./RuntimeError-cfbf2bc8","./Buffer","./base64","./ieee754","./isArray","./VarintReader","./snappyJs","./CodeTool","./GisTools","./VarintReaderV3","./ZstdLoader","./zstd_wasm","./Color-cad7c885","./Transforms-b1e48e05","./Ellipsoid-fa58f06f","./GeographicProjection-868b0b16","./Matrix3-59918a96","./Matrix2-e52b9454","./Cartesian2-0a34ed75","./ComponentDatatype-63fd8cd4","./WebGLConstants-7f557f93","./GeometryInstance-a555221e","./PolygonGeometry-9ef51ca3","./ArcType-26a3f38d","./BoundingRectangle-3100662d","./EllipsoidGeodesic-9e013872","./EllipsoidTangentPlane-8f36a7e0","./AxisAlignedBoundingBox-8b4e9f9c","./IntersectionTests-39c3b1c1","./Plane-f9bf6226","./Geometry-dd0ae099","./GeometryAttribute-5ac032ac","./GeometryOffsetAttribute-2579b8d2","./GeometryPipeline-92c34dd1","./AttributeCompression-44abee07","./EncodedCartesian3-e0f0a7d1","./IndexDatatype-ed8b21cb","./PolygonGeometryLibrary-37fe200f","./arrayRemoveDuplicates-d0608faf","./EllipsoidRhumbLine-cea00df6","./GeometryAttributes-3de79df5","./PolygonPipeline-d79010c3","./VertexFormat-01d05a0d","./PolygonOutlineGeometry-9f19e302","./Texture-3b0b528f","./PixelFormat-5109196d","./PrimitivePipeline-7bd2b931","./WebMercatorProjection-78306e76","./GetRidingLanternGeometry"],(function(e,t,r,o,n,i,l,a,s,u,f,c,y,d,h,g,p,m,P,G,v,A,b,x,w,C,D,R,T,B,F,V,E,I,L,M,k,S,W,j,q,O,H,N,z,J,_,U,Z,$,K,Q,X,Y,ee,te,re,oe,ne,ie){"use strict";let le,ae=512,se={},ue={},fe={};function ce(e,t){if("F"!=e[0])if(Array.isArray(e[0])){let r=e.length;for(let o=0;o<r;o++){ce(e[o],t)}}else t&&function(e){let t=[e[0],e[1]];for(let r=2;r<e.length;r++){let o=t[0]+e[r],n=t[1]+e[r+1];e[r]=o,e[r+1]=n,t=[o,n],r++}}(e);else e[0]=[.05*-ae,.05*-ae,1.05*ae,.05*-ae,1.05*ae,1.05*ae,.05*-ae,1.05*ae]}function ye(e,t){if(Array.isArray(t[0])){let r=t.length;for(let o=0;o<r;o++){ye(e,t[o])}}else e.push(t)}function de(e,t){let o=t.rectangle,n=[];for(let t=0;t<e.length;t++){let i=he(e[t],e[t+1],o),l=r.Cartesian3.fromDegrees(i[0],i[1]);n.push(l),t++}return n}function he(e,t,r){let o=ge(r.west+r.width/ae*e),n=ge(r.north-r.height/ae*t);return o=Number(o.toFixed(6)),n=Number(n.toFixed(6)),[o,n]}function ge(e){return 180*e/Math.PI}return e.createTaskProcessorWorker((function(e,r){if(1==e.init)return void function(e){le=new Function("render","level",e.styleStr),ae=e.tileSize,e.return_type,se=e,ue=e.serverInfo,fe=e.layerFieldMap;let t=l.defer();t.resolve(!0)}(e);let a=e.url,s=new t.Resource({url:a});s.request.throttle=!1,s.request.throttleByServer=!0,s.request.type=1;let u=s.fetchArrayBuffer();if(!u)return!0;let f=[];f.push(u);let c=l.defer();return Promise.all(f).then((function(t){let l=t[0];if(!l)return void c.resolve({});let a=function(e,t){if(e){!function(e,t){for(let r in e){let o=e[r].features;o||(o=e[r].datas);for(let e=0;e<o.length;e++)ce(o[e][2],t)}}(e,t.needDecode);let r={},n=new o([e],t.level,r,t.controlVector,t.highLightVector,t.filterLayerId);return le.call({},n,t.level),function(e){for(let t in e){let r=e[t];for(let e=0;e<r.length;e++){let t=r[e],o=[];ye(o,t.data),delete t.data,t.geometrys=o;let n=0;if(se.hasOwnProperty("heightProperty")){let e=se.heightProperty;n=t.properties[e],se.hasOwnProperty("heightScale")&&(n*=parseFloat(se.heightScale))}t.height=n,t.totalHeight=n}}}(r),r}return{}}(n(l,fe,ue),e);!function(e,t){for(let r in e){let o=e[r];for(let e=0;e<o.length;e++){let r=o[e];r.polygons=[];for(let e=0;e<r.geometrys.length;e++){let o=de(r.geometrys[e],t);r.polygons.push(o)}delete r.geometrys}}}(a,e);let s=i(a,e.level,se,r);c.resolve(s)}),(function(e){c.reject(e)})),c.promise}))}));
