define(["exports","./Cartesian2-0a34ed75","./defaultValue-9f6a6288","./defined-64766648","./PixelFormat-5109196d","./WebGLConstants-7f557f93"],(function(e,t,i,r,n,a){"use strict";function u(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function o(){return!0}function m(e,t){e.isDestroyed=o}const _={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object.defineProperties(_,{maximumCombinedTextureImageUnits:{get:function(){return _._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return _._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return _._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return _._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return _._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return _._maximumTextureSize}},maximumVaryingVectors:{get:function(){return _._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return _._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return _._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return _._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return _._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return _._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return _._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return _._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return _._maximumViewportWidth}},maximumViewportHeight:{get:function(){return _._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return _._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return _._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return _._maximumColorAttachments}},maximumSamples:{get:function(){return _._maximumSamples}},highpFloatSupported:{get:function(){return _._highpFloatSupported}},highpIntSupported:{get:function(){return _._highpIntSupported}}});var x=_;const s={DONT_CARE:a.WebGLConstants.DONT_CARE,FASTEST:a.WebGLConstants.FASTEST,NICEST:a.WebGLConstants.NICEST,validate:function(e){return e===s.DONT_CARE||e===s.FASTEST||e===s.NICEST}};var l=Object.freeze(s);const f={NEAREST:a.WebGLConstants.NEAREST,LINEAR:a.WebGLConstants.LINEAR,validate:function(e){return e===f.NEAREST||e===f.LINEAR}};var p=Object.freeze(f);const E={NEAREST:a.WebGLConstants.NEAREST,LINEAR:a.WebGLConstants.LINEAR,NEAREST_MIPMAP_NEAREST:a.WebGLConstants.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:a.WebGLConstants.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:a.WebGLConstants.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:a.WebGLConstants.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===E.NEAREST||e===E.LINEAR||e===E.NEAREST_MIPMAP_NEAREST||e===E.LINEAR_MIPMAP_NEAREST||e===E.NEAREST_MIPMAP_LINEAR||e===E.LINEAR_MIPMAP_LINEAR}};var A=Object.freeze(E);const h={CLAMP_TO_EDGE:a.WebGLConstants.CLAMP_TO_EDGE,REPEAT:a.WebGLConstants.REPEAT,MIRRORED_REPEAT:a.WebGLConstants.MIRRORED_REPEAT,validate:function(e){return e===h.CLAMP_TO_EDGE||e===h.REPEAT||e===h.MIRRORED_REPEAT}};var T=Object.freeze(h);function c(e){e=i.defaultValue(e,i.defaultValue.EMPTY_OBJECT);const t=i.defaultValue(e.wrapS,T.CLAMP_TO_EDGE),n=i.defaultValue(e.wrapT,T.CLAMP_TO_EDGE),a=i.defaultValue(e.minificationFilter,A.LINEAR),u=i.defaultValue(e.magnificationFilter,p.LINEAR),o=r.defined(e.maximumAnisotropy)?e.maximumAnisotropy:1;this._wrapS=t,this._wrapT=n,this._minificationFilter=a,this._magnificationFilter=u,this._maximumAnisotropy=o}function d(e){e=i.defaultValue(e,i.defaultValue.EMPTY_OBJECT);const{context:a,source:o,pixelFormat:m=n.PixelFormat.RGBA,pixelDatatype:_=n.PixelDatatype.UNSIGNED_BYTE,flipY:x=!0,skipColorSpaceConversion:s=!1,sampler:l=new c}=e;let{width:f,height:p}=e;r.defined(o)&&(r.defined(f)||(f=o.videoWidth??o.naturalWidth??o.width),r.defined(p)||(p=o.videoHeight??o.naturalHeight??o.height));const E=e.preMultiplyAlpha||m===n.PixelFormat.RGB||m===n.PixelFormat.LUMINANCE,A=n.PixelFormat.toInternalFormat(m,_,a),h=n.PixelFormat.isCompressedFormat(A),T=a._gl,d=h?n.PixelFormat.compressedTextureSizeInBytes(m,f,p):n.PixelFormat.textureSizeInBytes(m,_,f,p);if(this._id=u(),this._context=a,this._textureFilterAnisotropic=a._textureFilterAnisotropic,this._textureTarget=T.TEXTURE_2D,this._texture=T.createTexture(),this._internalFormat=A,this._pixelFormat=m,this._pixelDatatype=_,this._width=f,this._height=p,this._dimensions=new t.Cartesian2(f,p),this._hasMipmap=!1,this._sizeInBytes=d,this._preMultiplyAlpha=E,this._flipY=x,this._initialized=!1,this._sampler=void 0,this._sampler=l,S(this,l),T.activeTexture(T.TEXTURE0),T.bindTexture(this._textureTarget,this._texture),r.defined(o)){if(s?T.pixelStorei(T.UNPACK_COLORSPACE_CONVERSION_WEBGL,T.NONE):T.pixelStorei(T.UNPACK_COLORSPACE_CONVERSION_WEBGL,T.BROWSER_DEFAULT_WEBGL),r.defined(o.arrayBufferView)){n.PixelFormat.isCompressedFormat(A)?function(e,t){const i=e._context,n=i._gl,a=e._textureTarget,u=e._internalFormat,{width:o,height:m}=e;if(n.pixelStorei(n.UNPACK_ALIGNMENT,4),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.compressedTexImage2D(a,0,u,o,m,0,t.arrayBufferView),r.defined(t.mipLevels)){let e=o,i=m;for(let r=0;r<t.mipLevels.length;++r)e=L(e),i=L(i),n.compressedTexImage2D(a,r+1,u,e,i,0,t.mipLevels[r])}}(this,o):P(this,o)}else r.defined(o.framebuffer)?function(e,t){const i=e._context,r=i._gl;r.pixelStorei(r.UNPACK_ALIGNMENT,4),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),t.framebuffer!==i.defaultFramebuffer&&t.framebuffer._bind();r.copyTexImage2D(e._textureTarget,0,e._internalFormat,t.xOffset,t.yOffset,e.width,e.height,0),t.framebuffer!==i.defaultFramebuffer&&t.framebuffer._unBind()}(this,o):g(this,o);this._initialized=!0}else N(this);T.bindTexture(this._textureTarget,null)}function P(e,t){const i=e._context,a=i._gl,u=e._textureTarget,o=e._internalFormat,{width:m,height:_,pixelFormat:x,pixelDatatype:s,flipY:l}=e,f=n.PixelFormat.alignmentInBytes(x,s,m);a.pixelStorei(a.UNPACK_ALIGNMENT,f),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);let{arrayBufferView:p}=t;if(l&&(p=n.PixelFormat.flipY(p,x,s,m,_)),a.texImage2D(u,0,o,m,_,0,x,n.PixelDatatype.toWebGLConstant(s,i),p),r.defined(t.mipLevels)){let e=m,r=_;for(let m=0;m<t.mipLevels.length;++m)e=L(e),r=L(r),a.texImage2D(u,m+1,o,e,r,0,x,n.PixelDatatype.toWebGLConstant(s,i),t.mipLevels[m])}}function g(e,t){const i=e._context,r=i._gl;r.pixelStorei(r.UNPACK_ALIGNMENT,4),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.preMultiplyAlpha),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e.flipY),r.texImage2D(e._textureTarget,0,e._internalFormat,e.pixelFormat,n.PixelDatatype.toWebGLConstant(e.pixelDatatype,i),t)}function L(e){const t=0|Math.floor(e/2);return Math.max(t,1)}function N(e){const t=e._context;t._gl.texImage2D(e._textureTarget,0,e._internalFormat,e._width,e._height,0,e._pixelFormat,n.PixelDatatype.toWebGLConstant(e._pixelDatatype,t),null)}function S(e,t){let{minificationFilter:i,magnificationFilter:a}=t;const u=[A.NEAREST_MIPMAP_NEAREST,A.NEAREST_MIPMAP_LINEAR,A.LINEAR_MIPMAP_NEAREST,A.LINEAR_MIPMAP_LINEAR].includes(i),o=e._context,m=e._pixelFormat,_=e._pixelDatatype;(_===n.PixelDatatype.FLOAT&&!o.textureFloatLinear||_===n.PixelDatatype.HALF_FLOAT&&!o.textureHalfFloatLinear)&&(i=u?A.NEAREST_MIPMAP_NEAREST:A.NEAREST,a=p.NEAREST),o.webgl2&&n.PixelFormat.isDepthFormat(m)&&(i=A.NEAREST,a=p.NEAREST);const x=o._gl,s=e._textureTarget;x.activeTexture(x.TEXTURE0),x.bindTexture(s,e._texture),x.texParameteri(s,x.TEXTURE_MIN_FILTER,i),x.texParameteri(s,x.TEXTURE_MAG_FILTER,a),x.texParameteri(s,x.TEXTURE_WRAP_S,t.wrapS),x.texParameteri(s,x.TEXTURE_WRAP_T,t.wrapT),r.defined(e._textureFilterAnisotropic)&&x.texParameteri(s,e._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),x.bindTexture(s,null)}Object.defineProperties(c.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),c.equals=function(e,t){return e===t||r.defined(e)&&r.defined(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy},c.NEAREST=Object.freeze(new c({wrapS:T.CLAMP_TO_EDGE,wrapT:T.CLAMP_TO_EDGE,minificationFilter:A.NEAREST,magnificationFilter:p.NEAREST})),d.create=function(e){return new d(e)},d.fromFramebuffer=function(e){const t=(e=i.defaultValue(e,i.defaultValue.EMPTY_OBJECT)).context,a=t._gl,{pixelFormat:u=n.PixelFormat.RGB,framebufferXOffset:o=0,framebufferYOffset:m=0,width:_=a.drawingBufferWidth,height:x=a.drawingBufferHeight,framebuffer:s}=e;return new d({context:t,width:_,height:x,pixelFormat:u,source:{framebuffer:r.defined(s)?s:t.defaultFramebuffer,xOffset:o,yOffset:m,width:_,height:x}})},Object.defineProperties(d.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){S(this,e),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),d.prototype.copyFrom=function(e){const{xOffset:t=0,yOffset:i=0,source:a,skipColorSpaceConversion:u=!1}=e,o=this._context._gl,m=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(m,this._texture);let{width:_,height:x}=a;r.defined(a.videoWidth)&&r.defined(a.videoHeight)?(_=a.videoWidth,x=a.videoHeight):r.defined(a.naturalWidth)&&r.defined(a.naturalHeight)&&(_=a.naturalWidth,x=a.naturalHeight),u?o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE):o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.BROWSER_DEFAULT_WEBGL);let s=!1;this._initialized||(0===t&&0===i&&_===this._width&&x===this._height?(r.defined(a.arrayBufferView)?P(this,a):g(this,a),s=!0):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),N(this)),this._initialized=!0),s||(r.defined(a.arrayBufferView)?function(e,t,i,r,a,u){const o=e._context,m=o._gl,{pixelFormat:_,pixelDatatype:x}=e,s=n.PixelFormat.alignmentInBytes(_,x,a);m.pixelStorei(m.UNPACK_ALIGNMENT,s),m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1),e.flipY&&(t=n.PixelFormat.flipY(t,_,x,a,u)),m.texSubImage2D(e._textureTarget,0,i,r,a,u,_,n.PixelDatatype.toWebGLConstant(x,o),t)}(this,a.arrayBufferView,t,i,_,x):function(e,t,i,r){const a=e._context,u=a._gl;u.pixelStorei(u.UNPACK_ALIGNMENT,4),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.preMultiplyAlpha),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,e.flipY),u.texSubImage2D(e._textureTarget,0,i,r,e.pixelFormat,n.PixelDatatype.toWebGLConstant(e.pixelDatatype,a),t)}(this,a,t,i)),o.bindTexture(m,null)},d.prototype.copyFromFramebuffer=function(e,t,r,n,a,u){e=i.defaultValue(e,0),t=i.defaultValue(t,0),r=i.defaultValue(r,0),n=i.defaultValue(n,0),a=i.defaultValue(a,this._width),u=i.defaultValue(u,this._height);const o=this._context._gl,m=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(m,this._texture),o.copyTexSubImage2D(m,0,e,t,r,n,a,u),o.bindTexture(m,null),this._initialized=!0},d.prototype.generateMipmap=function(e){e=i.defaultValue(e,l.DONT_CARE),this._hasMipmap=!0;const t=this._context._gl,r=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(r,this._texture),t.generateMipmap(r),t.bindTexture(r,null)},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),m(this)},e.ContextLimits=x,e.MipmapHint=l,e.Sampler=c,e.Texture=d,e.TextureMagnificationFilter=p,e.TextureMinificationFilter=A,e.TextureWrap=T,e.createGuid=u,e.destroyObject=m}));
