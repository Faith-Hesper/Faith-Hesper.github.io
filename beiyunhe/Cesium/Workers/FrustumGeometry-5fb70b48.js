define(["exports","./Transforms-b1e48e05","./Cartesian3-e96ac170","./Matrix2-e52b9454","./ComponentDatatype-63fd8cd4","./defaultValue-9f6a6288","./defined-64766648","./Geometry-dd0ae099","./GeometryAttribute-5ac032ac","./GeometryAttributes-3de79df5","./Matrix3-59918a96","./Math-56779564","./Plane-f9bf6226","./VertexFormat-01d05a0d"],(function(t,e,a,n,i,r,o,s,f,u,l,c,h,p){"use strict";function d(t){this.planes=r.defaultValue(t,[])}const m=[new a.Cartesian3,new a.Cartesian3,new a.Cartesian3];a.Cartesian3.clone(a.Cartesian3.UNIT_X,m[0]),a.Cartesian3.clone(a.Cartesian3.UNIT_Y,m[1]),a.Cartesian3.clone(a.Cartesian3.UNIT_Z,m[2]);const C=new a.Cartesian3,_=new a.Cartesian3,y=new h.Plane(new a.Cartesian3(1,0,0),0);function g(t){t=r.defaultValue(t,r.defaultValue.EMPTY_OBJECT),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=r.defaultValue(t.near,1),this._near=this.near,this.far=r.defaultValue(t.far,5e8),this._far=this.far,this._cullingVolume=new d,this._orthographicMatrix=new n.Matrix4}function w(t){t.top===t._top&&t.bottom===t._bottom&&t.left===t._left&&t.right===t._right&&t.near===t._near&&t.far===t._far||(t._left=t.left,t._right=t.right,t._top=t.top,t._bottom=t.bottom,t._near=t.near,t._far=t.far,t._orthographicMatrix=n.Matrix4.computeOrthographicOffCenter(t.left,t.right,t.bottom,t.top,t.near,t.far,t._orthographicMatrix))}d.fromBoundingSphere=function(t,e){o.defined(e)||(e=new d);const i=m.length,r=e.planes;r.length=2*i;const s=t.center,f=t.radius;let u=0;for(let t=0;t<i;++t){const e=m[t];let i=r[u],l=r[u+1];o.defined(i)||(i=r[u]=new n.Cartesian4),o.defined(l)||(l=r[u+1]=new n.Cartesian4),a.Cartesian3.multiplyByScalar(e,-f,C),a.Cartesian3.add(s,C,C),i.x=e.x,i.y=e.y,i.z=e.z,i.w=-a.Cartesian3.dot(e,C),a.Cartesian3.multiplyByScalar(e,f,C),a.Cartesian3.add(s,C,C),l.x=-e.x,l.y=-e.y,l.z=-e.z,l.w=-a.Cartesian3.dot(a.Cartesian3.negate(e,_),C),u+=2}return e},d.prototype.computeVisibility=function(t){const a=this.planes;let n=!1;for(let i=0,r=a.length;i<r;++i){const r=t.intersectPlane(h.Plane.fromCartesian4(a[i],y));if(r===e.Intersect.OUTSIDE)return e.Intersect.OUTSIDE;r===e.Intersect.INTERSECTING&&(n=!0)}return n?e.Intersect.INTERSECTING:e.Intersect.INSIDE},d.prototype.computeVisibilityWithPlaneMask=function(t,a){if(a===d.MASK_OUTSIDE||a===d.MASK_INSIDE)return a;let n=d.MASK_INSIDE;const i=this.planes;for(let r=0,o=i.length;r<o;++r){const o=r<31?1<<r:0;if(r<31&&0==(a&o))continue;const s=t.intersectPlane(h.Plane.fromCartesian4(i[r],y));if(s===e.Intersect.OUTSIDE)return d.MASK_OUTSIDE;s===e.Intersect.INTERSECTING&&(n|=o)}return n},d.MASK_OUTSIDE=4294967295,d.MASK_INSIDE=0,d.MASK_INDETERMINATE=2147483647,Object.defineProperties(g.prototype,{projectionMatrix:{get:function(){return w(this),this._orthographicMatrix}}});const x=new a.Cartesian3,v=new a.Cartesian3,M=new a.Cartesian3,b=new a.Cartesian3;function F(t){t=r.defaultValue(t,r.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new g,this.width=t.width,this._width=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=r.defaultValue(t.near,1),this._near=this.near,this.far=r.defaultValue(t.far,5e8),this._far=this.far}function V(t){const e=t._offCenterFrustum;if(t.width!==t._width||t.aspectRatio!==t._aspectRatio||t.near!==t._near||t.far!==t._far){t._aspectRatio=t.aspectRatio,t._width=t.width,t._near=t.near,t._far=t.far;const a=1/t.aspectRatio;e.right=.5*t.width,e.left=-e.right,e.top=a*e.right,e.bottom=-e.top,e.near=t.near,e.far=t.far}}function P(t){t=r.defaultValue(t,r.defaultValue.EMPTY_OBJECT),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=r.defaultValue(t.near,1),this._near=this.near,this.far=r.defaultValue(t.far,5e8),this._far=this.far,this._cullingVolume=new d,this._perspectiveMatrix=new n.Matrix4,this._infinitePerspective=new n.Matrix4,this._clipPlane=null}function E(t,e){const a=new n.Cartesian4;a.x=(Math.sign(t.x)+e[8])/e[0],a.y=(Math.sign(t.y)+e[9])/e[5],a.z=-1,a.w=(1+e[10])/e[14];const i=2/n.Cartesian4.dot(t,a),r=n.Cartesian4.multiplyByScalar(t,i,new n.Cartesian4);e[2]=r.x,e[6]=r.y,e[10]=r.z+1-0,e[14]=r.w}function O(t){const e=t.top,a=t.bottom,i=t.right,r=t.left,o=t.near,s=t.far;e===t._top&&a===t._bottom&&r===t._left&&i===t._right&&o===t._near&&s===t._far||(t._left=r,t._right=i,t._top=e,t._bottom=a,t._near=o,t._far=s,t._perspectiveMatrix=n.Matrix4.computePerspectiveOffCenter(r,i,a,e,o,s,t._perspectiveMatrix),t._clipPlane&&E(t._clipPlane,t._perspectiveMatrix),t._infinitePerspective=n.Matrix4.computeInfinitePerspectiveOffCenter(r,i,a,e,o,t._infinitePerspective),t._clipPlane&&E(t._clipPlane,t._infinitePerspective))}g.prototype.computeCullingVolume=function(t,e,i){const r=this._cullingVolume.planes,s=this.top,f=this.bottom,u=this.right,l=this.left,c=this.near,h=this.far,p=a.Cartesian3.cross(e,i,x);a.Cartesian3.normalize(p,p);const d=v;a.Cartesian3.multiplyByScalar(e,c,d),a.Cartesian3.add(t,d,d);const m=M;a.Cartesian3.multiplyByScalar(p,l,m),a.Cartesian3.add(d,m,m);let C=r[0];return o.defined(C)||(C=r[0]=new n.Cartesian4),C.x=p.x,C.y=p.y,C.z=p.z,C.w=-a.Cartesian3.dot(p,m),a.Cartesian3.multiplyByScalar(p,u,m),a.Cartesian3.add(d,m,m),C=r[1],o.defined(C)||(C=r[1]=new n.Cartesian4),C.x=-p.x,C.y=-p.y,C.z=-p.z,C.w=-a.Cartesian3.dot(a.Cartesian3.negate(p,b),m),a.Cartesian3.multiplyByScalar(i,f,m),a.Cartesian3.add(d,m,m),C=r[2],o.defined(C)||(C=r[2]=new n.Cartesian4),C.x=i.x,C.y=i.y,C.z=i.z,C.w=-a.Cartesian3.dot(i,m),a.Cartesian3.multiplyByScalar(i,s,m),a.Cartesian3.add(d,m,m),C=r[3],o.defined(C)||(C=r[3]=new n.Cartesian4),C.x=-i.x,C.y=-i.y,C.z=-i.z,C.w=-a.Cartesian3.dot(a.Cartesian3.negate(i,b),m),C=r[4],o.defined(C)||(C=r[4]=new n.Cartesian4),C.x=e.x,C.y=e.y,C.z=e.z,C.w=-a.Cartesian3.dot(e,d),a.Cartesian3.multiplyByScalar(e,h,m),a.Cartesian3.add(t,m,m),C=r[5],o.defined(C)||(C=r[5]=new n.Cartesian4),C.x=-e.x,C.y=-e.y,C.z=-e.z,C.w=-a.Cartesian3.dot(a.Cartesian3.negate(e,b),m),this._cullingVolume},g.prototype.getPixelDimensions=function(t,e,a,n,i){w(this);const r=n*(this.right-this.left)/t,o=n*(this.top-this.bottom)/e;return i.x=r,i.y=o,i},g.prototype.clone=function(t){return o.defined(t)||(t=new g),t.left=this.left,t.right=this.right,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t._left=void 0,t._right=void 0,t._top=void 0,t._bottom=void 0,t._near=void 0,t._far=void 0,t},g.prototype.equals=function(t){return o.defined(t)&&t instanceof g&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far},g.prototype.equalsEpsilon=function(t,e,a){return t===this||o.defined(t)&&t instanceof g&&c.CesiumMath.equalsEpsilon(this.right,t.right,e,a)&&c.CesiumMath.equalsEpsilon(this.left,t.left,e,a)&&c.CesiumMath.equalsEpsilon(this.top,t.top,e,a)&&c.CesiumMath.equalsEpsilon(this.bottom,t.bottom,e,a)&&c.CesiumMath.equalsEpsilon(this.near,t.near,e,a)&&c.CesiumMath.equalsEpsilon(this.far,t.far,e,a)},F.packedLength=4,F.pack=function(t,e,a){return a=r.defaultValue(a,0),e[a++]=t.width,e[a++]=t.aspectRatio,e[a++]=t.near,e[a]=t.far,e},F.unpack=function(t,e,a){return e=r.defaultValue(e,0),o.defined(a)||(a=new F),a.width=t[e++],a.aspectRatio=t[e++],a.near=t[e++],a.far=t[e],a},Object.defineProperties(F.prototype,{projectionMatrix:{get:function(){return V(this),this._offCenterFrustum.projectionMatrix}},offCenterFrustum:{get:function(){return V(this),this._offCenterFrustum}}}),F.prototype.computeCullingVolume=function(t,e,a){return V(this),this._offCenterFrustum.computeCullingVolume(t,e,a)},F.prototype.getPixelDimensions=function(t,e,a,n,i){return V(this),this._offCenterFrustum.getPixelDimensions(t,e,a,n,i)},F.prototype.clone=function(t){return o.defined(t)||(t=new F),t.aspectRatio=this.aspectRatio,t.width=this.width,t.near=this.near,t.far=this.far,t._aspectRatio=void 0,t._width=void 0,t._near=void 0,t._far=void 0,this._offCenterFrustum.clone(t._offCenterFrustum),t},F.prototype.equals=function(t){return!!(o.defined(t)&&t instanceof F)&&(V(this),V(t),this.width===t.width&&this.aspectRatio===t.aspectRatio&&this._offCenterFrustum.equals(t._offCenterFrustum))},F.prototype.equalsEpsilon=function(t,e,a){return!!(o.defined(t)&&t instanceof F)&&(V(this),V(t),c.CesiumMath.equalsEpsilon(this.width,t.width,e,a)&&c.CesiumMath.equalsEpsilon(this.aspectRatio,t.aspectRatio,e,a)&&this._offCenterFrustum.equalsEpsilon(t._offCenterFrustum,e,a))},Object.defineProperties(P.prototype,{projectionMatrix:{get:function(){return O(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return O(this),this._infinitePerspective}}});const z=new a.Cartesian3,R=new a.Cartesian3,S=new a.Cartesian3,T=new a.Cartesian3;function k(t){t=r.defaultValue(t,r.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new P,this.fov=t.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=r.defaultValue(t.near,1),this._near=this.near,this.far=r.defaultValue(t.far,5e8),this._far=this.far,this.xOffset=r.defaultValue(t.xOffset,0),this._xOffset=this.xOffset,this.yOffset=r.defaultValue(t.yOffset,0),this._yOffset=this.yOffset}function A(t){const e=t._offCenterFrustum;t.fov===t._fov&&t.aspectRatio===t._aspectRatio&&t.near===t._near&&t.far===t._far&&t.xOffset===t._xOffset&&t.yOffset===t._yOffset||(t._aspectRatio=t.aspectRatio,t._fov=t.fov,t._fovy=t.aspectRatio<=1?t.fov:2*Math.atan(Math.tan(.5*t.fov)/t.aspectRatio),t._near=t.near,t._far=t.far,t._sseDenominator=2*Math.tan(.5*t._fovy),t._xOffset=t.xOffset,t._yOffset=t.yOffset,e.top=t.near*Math.tan(.5*t._fovy),e.bottom=-e.top,e.right=t.aspectRatio*e.top,e.left=-e.right,e.near=t.near,e.far=t.far,e.right+=t.xOffset,e.left+=t.xOffset,e.top+=t.yOffset,e.bottom+=t.yOffset)}P.prototype.computeCullingVolume=function(t,e,i){const r=this._cullingVolume.planes,s=this.top,f=this.bottom,u=this.right,l=this.left,c=this.near,h=this.far,p=a.Cartesian3.cross(e,i,z),d=R;a.Cartesian3.multiplyByScalar(e,c,d),a.Cartesian3.add(t,d,d);const m=S;a.Cartesian3.multiplyByScalar(e,h,m),a.Cartesian3.add(t,m,m);const C=T;a.Cartesian3.multiplyByScalar(p,l,C),a.Cartesian3.add(d,C,C),a.Cartesian3.subtract(C,t,C),a.Cartesian3.normalize(C,C),a.Cartesian3.cross(C,i,C),a.Cartesian3.normalize(C,C);let _=r[0];return o.defined(_)||(_=r[0]=new n.Cartesian4),_.x=C.x,_.y=C.y,_.z=C.z,_.w=-a.Cartesian3.dot(C,t),a.Cartesian3.multiplyByScalar(p,u,C),a.Cartesian3.add(d,C,C),a.Cartesian3.subtract(C,t,C),a.Cartesian3.cross(i,C,C),a.Cartesian3.normalize(C,C),_=r[1],o.defined(_)||(_=r[1]=new n.Cartesian4),_.x=C.x,_.y=C.y,_.z=C.z,_.w=-a.Cartesian3.dot(C,t),a.Cartesian3.multiplyByScalar(i,f,C),a.Cartesian3.add(d,C,C),a.Cartesian3.subtract(C,t,C),a.Cartesian3.cross(p,C,C),a.Cartesian3.normalize(C,C),_=r[2],o.defined(_)||(_=r[2]=new n.Cartesian4),_.x=C.x,_.y=C.y,_.z=C.z,_.w=-a.Cartesian3.dot(C,t),a.Cartesian3.multiplyByScalar(i,s,C),a.Cartesian3.add(d,C,C),a.Cartesian3.subtract(C,t,C),a.Cartesian3.cross(C,p,C),a.Cartesian3.normalize(C,C),_=r[3],o.defined(_)||(_=r[3]=new n.Cartesian4),_.x=C.x,_.y=C.y,_.z=C.z,_.w=-a.Cartesian3.dot(C,t),_=r[4],o.defined(_)||(_=r[4]=new n.Cartesian4),_.x=e.x,_.y=e.y,_.z=e.z,_.w=-a.Cartesian3.dot(e,d),a.Cartesian3.negate(e,C),_=r[5],o.defined(_)||(_=r[5]=new n.Cartesian4),_.x=C.x,_.y=C.y,_.z=C.z,_.w=-a.Cartesian3.dot(C,m),this._cullingVolume},P.prototype.getPixelDimensions=function(t,e,a,n,i){O(this);const r=1/this.near;let o=this.top*r;const s=2*n*a*o/e;o=this.right*r;const f=2*n*a*o/t;return i.x=f,i.y=s,i},P.prototype.clone=function(t){return o.defined(t)||(t=new P),t.right=this.right,t.left=this.left,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t._left=void 0,t._right=void 0,t._top=void 0,t._bottom=void 0,t._near=void 0,t._far=void 0,t._clipPlane=this._clipPlane,t},P.prototype.equals=function(t){return o.defined(t)&&t instanceof P&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far},P.prototype.equalsEpsilon=function(t,e,a){return t===this||o.defined(t)&&t instanceof P&&c.CesiumMath.equalsEpsilon(this.right,t.right,e,a)&&c.CesiumMath.equalsEpsilon(this.left,t.left,e,a)&&c.CesiumMath.equalsEpsilon(this.top,t.top,e,a)&&c.CesiumMath.equalsEpsilon(this.bottom,t.bottom,e,a)&&c.CesiumMath.equalsEpsilon(this.near,t.near,e,a)&&c.CesiumMath.equalsEpsilon(this.far,t.far,e,a)},k.packedLength=6,k.pack=function(t,e,a){return a=r.defaultValue(a,0),e[a++]=t.fov,e[a++]=t.aspectRatio,e[a++]=t.near,e[a++]=t.far,e[a++]=t.xOffset,e[a]=t.yOffset,e},k.unpack=function(t,e,a){return e=r.defaultValue(e,0),o.defined(a)||(a=new k),a.fov=t[e++],a.aspectRatio=t[e++],a.near=t[e++],a.far=t[e++],a.xOffset=t[e++],a.yOffset=t[e],a},Object.defineProperties(k.prototype,{projectionMatrix:{get:function(){return A(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return A(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return A(this),this._fovy}},sseDenominator:{get:function(){return A(this),this._sseDenominator}},offCenterFrustum:{get:function(){return A(this),this._offCenterFrustum}}}),k.prototype.computeCullingVolume=function(t,e,a){return A(this),this._offCenterFrustum.computeCullingVolume(t,e,a)},k.prototype.getPixelDimensions=function(t,e,a,n,i){return A(this),this._offCenterFrustum.getPixelDimensions(t,e,a,n,i)},k.prototype.clone=function(t){return o.defined(t)||(t=new k),t.aspectRatio=this.aspectRatio,t.fov=this.fov,t.near=this.near,t.far=this.far,t._aspectRatio=void 0,t._fov=void 0,t._near=void 0,t._far=void 0,this._offCenterFrustum.clone(t._offCenterFrustum),t},k.prototype.equals=function(t){return!!(o.defined(t)&&t instanceof k)&&(A(this),A(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this._offCenterFrustum.equals(t._offCenterFrustum))},k.prototype.equalsEpsilon=function(t,e,a){return!!(o.defined(t)&&t instanceof k)&&(A(this),A(t),c.CesiumMath.equalsEpsilon(this.fov,t.fov,e,a)&&c.CesiumMath.equalsEpsilon(this.aspectRatio,t.aspectRatio,e,a)&&this._offCenterFrustum.equalsEpsilon(t._offCenterFrustum,e,a))};function D(t){const n=t.frustum,i=t.orientation,o=t.origin,s=r.defaultValue(t.vertexFormat,p.VertexFormat.DEFAULT),f=r.defaultValue(t._drawNearPlane,!0);let u,l;n instanceof k?(u=0,l=k.packedLength):n instanceof F&&(u=1,l=F.packedLength),this._frustumType=u,this._frustum=n.clone(),this._origin=a.Cartesian3.clone(o),this._orientation=e.Quaternion.clone(i),this._drawNearPlane=f,this._vertexFormat=s,this._workerName="createFrustumGeometry",this.packedLength=2+l+a.Cartesian3.packedLength+e.Quaternion.packedLength+p.VertexFormat.packedLength}D.pack=function(t,n,i){i=r.defaultValue(i,0);const o=t._frustumType,s=t._frustum;return n[i++]=o,0===o?(k.pack(s,n,i),i+=k.packedLength):(F.pack(s,n,i),i+=F.packedLength),a.Cartesian3.pack(t._origin,n,i),i+=a.Cartesian3.packedLength,e.Quaternion.pack(t._orientation,n,i),i+=e.Quaternion.packedLength,p.VertexFormat.pack(t._vertexFormat,n,i),n[i+=p.VertexFormat.packedLength]=t._drawNearPlane?1:0,n};const I=new k,q=new F,B=new e.Quaternion,L=new a.Cartesian3,N=new p.VertexFormat;function G(t,e,a,n,i,r,s,f){const u=t/3*2;for(let i=0;i<4;++i)o.defined(e)&&(e[t]=r.x,e[t+1]=r.y,e[t+2]=r.z),o.defined(a)&&(a[t]=s.x,a[t+1]=s.y,a[t+2]=s.z),o.defined(n)&&(n[t]=f.x,n[t+1]=f.y,n[t+2]=f.z),t+=3;i[u]=0,i[u+1]=0,i[u+2]=1,i[u+3]=0,i[u+4]=1,i[u+5]=1,i[u+6]=0,i[u+7]=1}D.unpack=function(t,n,i){n=r.defaultValue(n,0);const s=t[n++];let f;0===s?(f=k.unpack(t,n,I),n+=k.packedLength):(f=F.unpack(t,n,q),n+=F.packedLength);const u=a.Cartesian3.unpack(t,n,L);n+=a.Cartesian3.packedLength;const l=e.Quaternion.unpack(t,n,B);n+=e.Quaternion.packedLength;const c=p.VertexFormat.unpack(t,n,N),h=1===t[n+=p.VertexFormat.packedLength];if(!o.defined(i))return new D({frustum:f,origin:u,orientation:l,vertexFormat:c,_drawNearPlane:h});const d=s===i._frustumType?i._frustum:void 0;return i._frustum=f.clone(d),i._frustumType=s,i._origin=a.Cartesian3.clone(u,i._origin),i._orientation=e.Quaternion.clone(l,i._orientation),i._vertexFormat=p.VertexFormat.clone(c,i._vertexFormat),i._drawNearPlane=h,i};const j=new l.Matrix3,U=new n.Matrix4,Q=new n.Matrix4,K=new a.Cartesian3,Y=new a.Cartesian3,J=new a.Cartesian3,W=new a.Cartesian3,X=new a.Cartesian3,Z=new a.Cartesian3,H=new Array(3),$=new Array(4);$[0]=new n.Cartesian4(-1,-1,1,1),$[1]=new n.Cartesian4(1,-1,1,1),$[2]=new n.Cartesian4(1,1,1,1),$[3]=new n.Cartesian4(-1,1,1,1);const tt=new Array(4);for(let t=0;t<4;++t)tt[t]=new n.Cartesian4;D._computeNearFarPlanes=function(t,e,i,s,f,u,c,h){const p=l.Matrix3.fromQuaternion(e,j);let d=r.defaultValue(u,K),m=r.defaultValue(c,Y),C=r.defaultValue(h,J);d=l.Matrix3.getColumn(p,0,d),m=l.Matrix3.getColumn(p,1,m),C=l.Matrix3.getColumn(p,2,C),a.Cartesian3.normalize(d,d),a.Cartesian3.normalize(m,m),a.Cartesian3.normalize(C,C),a.Cartesian3.negate(d,d);const _=n.Matrix4.computeView(t,C,m,d,U);let y,g;const w=s.projectionMatrix;if(0===i){const t=n.Matrix4.multiply(w,_,Q);g=n.Matrix4.inverse(t,Q)}else y=n.Matrix4.inverseTransformation(_,Q);o.defined(g)?(H[0]=s.near,H[1]=s.far):(H[0]=0,H[1]=s.near,H[2]=s.far);for(let e=0;e<2;++e)for(let i=0;i<4;++i){let r=n.Cartesian4.clone($[i],tt[i]);if(o.defined(g)){r=n.Matrix4.multiplyByVector(g,r,r);const i=1/r.w;a.Cartesian3.multiplyByScalar(r,i,r),a.Cartesian3.subtract(r,t,r),a.Cartesian3.normalize(r,r);const o=a.Cartesian3.dot(C,r);a.Cartesian3.multiplyByScalar(r,H[e]/o,r),a.Cartesian3.add(r,t,r)}else{const t=s.offCenterFrustum;o.defined(t)&&(s=t);const a=H[e],i=H[e+1];r.x=.5*(r.x*(s.right-s.left)+s.left+s.right),r.y=.5*(r.y*(s.top-s.bottom)+s.bottom+s.top),r.z=.5*(r.z*(a-i)-a-i),r.w=1,n.Matrix4.multiplyByVector(y,r,r)}f[12*e+3*i]=r.x,f[12*e+3*i+1]=r.y,f[12*e+3*i+2]=r.z}},D.createGeometry=function(t){const n=t._frustumType,r=t._frustum,l=t._origin,c=t._orientation,h=t._drawNearPlane,p=t._vertexFormat,d=h?6:5;let m=new Float64Array(72);D._computeNearFarPlanes(l,c,n,r,m);let C=24;m[C]=m[12],m[C+1]=m[13],m[C+2]=m[14],m[C+3]=m[0],m[C+4]=m[1],m[C+5]=m[2],m[C+6]=m[9],m[C+7]=m[10],m[C+8]=m[11],m[C+9]=m[21],m[C+10]=m[22],m[C+11]=m[23],C+=12,m[C]=m[15],m[C+1]=m[16],m[C+2]=m[17],m[C+3]=m[3],m[C+4]=m[4],m[C+5]=m[5],m[C+6]=m[0],m[C+7]=m[1],m[C+8]=m[2],m[C+9]=m[12],m[C+10]=m[13],m[C+11]=m[14],C+=12,m[C]=m[3],m[C+1]=m[4],m[C+2]=m[5],m[C+3]=m[15],m[C+4]=m[16],m[C+5]=m[17],m[C+6]=m[18],m[C+7]=m[19],m[C+8]=m[20],m[C+9]=m[6],m[C+10]=m[7],m[C+11]=m[8],C+=12,m[C]=m[6],m[C+1]=m[7],m[C+2]=m[8],m[C+3]=m[18],m[C+4]=m[19],m[C+5]=m[20],m[C+6]=m[21],m[C+7]=m[22],m[C+8]=m[23],m[C+9]=m[9],m[C+10]=m[10],m[C+11]=m[11],h||(m=m.subarray(12));const _=new u.GeometryAttributes({position:new f.GeometryAttribute({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m})});if(o.defined(p.normal)||o.defined(p.tangent)||o.defined(p.bitangent)||o.defined(p.st)){const t=o.defined(p.normal)?new Float32Array(12*d):void 0,e=o.defined(p.tangent)?new Float32Array(12*d):void 0,n=o.defined(p.bitangent)?new Float32Array(12*d):void 0,r=o.defined(p.st)?new Float32Array(8*d):void 0,s=K,u=Y,l=J,c=a.Cartesian3.negate(s,W),m=a.Cartesian3.negate(u,X),y=a.Cartesian3.negate(l,Z);C=0,h&&(G(C,t,e,n,r,y,s,u),C+=12),G(C,t,e,n,r,l,c,u),C+=12,G(C,t,e,n,r,c,y,u),C+=12,G(C,t,e,n,r,m,y,c),C+=12,G(C,t,e,n,r,s,l,u),C+=12,G(C,t,e,n,r,u,l,c),o.defined(t)&&(_.normal=new f.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:t})),o.defined(e)&&(_.tangent=new f.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:e})),o.defined(n)&&(_.bitangent=new f.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:n})),o.defined(r)&&(_.st=new f.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:r}))}const y=new Uint16Array(6*d);for(let t=0;t<d;++t){const e=6*t,a=4*t;y[e]=a,y[e+1]=a+1,y[e+2]=a+2,y[e+3]=a,y[e+4]=a+2,y[e+5]=a+3}return new s.Geometry({attributes:_,indices:y,primitiveType:s.PrimitiveType.TRIANGLES,boundingSphere:e.BoundingSphere.fromVertices(m)})},t.FrustumGeometry=D,t.OrthographicFrustum=F,t.PerspectiveFrustum=k}));
