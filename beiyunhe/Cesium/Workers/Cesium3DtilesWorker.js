define(["./createTaskProcessorWorker-03824364","./IndexDBTool","./defer-7878b392","./defaultValue-9f6a6288","./defined-64766648"],(function(e,r,t,n,l){"use strict";let u=null,o="",s=[],f={},i=!1,c=20;function d(){let e=[],t=[];for(let r=0;r<c&&0!=s.length;r++){let n=s.shift();delete f[n.url],n.url?(e.push(n.url),t.push(n.defer)):r--}i=!0,r.getByPkeys(u,o,e,t).then((function(e){0==s.length?i=!1:d()}))}return e.createTaskProcessorWorker((function(e,n){if(1==e.init){o=e.tName,c=e.count;let n=t.defer();return r.createDB(o,"key",!1,"keyIndex","key").then((function(e){u=e,n.resolve()}),(function(e){n.resolve()})),n.promise}if("find"==e.type){let r=e.url,n=t.defer(),l={url:r,defer:n};return s.push(l),f[r]=l,i||d(),n.promise}return"save"==e.type?(l=e.tiles,r.setByKeys(u,o,l)):"cancel"==e.type?function(e){let r=f[e];r&&(r.url=null,r.defer.resolve("cancel"),delete f[e]);return}(e.url):void 0;var l}))}));
