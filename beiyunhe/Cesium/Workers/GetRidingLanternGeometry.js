define(["./Color-cad7c885","./GeometryInstance-a555221e","./Geometry-dd0ae099","./GeometryAttribute-5ac032ac","./ComponentDatatype-63fd8cd4","./Ellipsoid-fa58f06f","./Transforms-b1e48e05","./defaultValue-9f6a6288","./defined-64766648","./Math-56779564","./Matrix2-e52b9454","./Cartesian3-e96ac170","./Matrix3-59918a96","./RuntimeError-cfbf2bc8","./Cartesian2-0a34ed75","./WebGLConstants-7f557f93","./GeographicProjection-868b0b16","./Resource-be841477","./combine-ac72e009","./defer-7878b392"],(function(t,e,s,i,o,r,n,a,h,p,l,u,c,m,y,d,g,A,G,f){"use strict";return class{constructor(e){this.positions=null,this.normals=null,this.sts=null,this.indices=null,this.geometrys=e.positions,this.color=e.color,this.u_tcolor=e.u_tcolor||t.Color.YELLOW,this.height=e.height||500,this.speed=e.speed||600,this.direction=e.direction||-1,this.translucent=e.translucent||!1,this.type=e.type||1}createGeometryInstances(){let t=[];for(let s=0;s<this.geometrys.length;s++){let i=this.geometrys[s],o=this.computePositions_dws(i,this.height);this.positions=o.pos,this.normals=o.normals,this.sts=o.sts,this.indices=o.indices;let r=this.createGeometry(this.positions,this.normals,this.sts,this.indices),n=new e.GeometryInstance({id:Math.random(),geometry:r});t.push(n)}return t}createGeometry(t,e,r,a){let h=new Float64Array(t),p=new Float32Array(e),l=new Float32Array(r),u=new Uint16Array(a);return new s.Geometry({attributes:{position:new i.GeometryAttribute({componentDatatype:o.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:h}),normal:new i.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:p}),st:new i.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:l})},indices:u,primitiveType:s.PrimitiveType.TRIANGLES,boundingSphere:n.BoundingSphere.fromVertices(h)})}computePositions_dws(t,e){let s=t.length,i=[];for(let s in t)i.push(this.addHeight(t[s],e));let o=[],r=[],n=[],a=[];for(let e=0;e<s-1;e++){let s=e+1;o.push(t[e].x,t[e].y,t[e].z),o.push(t[s].x,t[s].y,t[s].z),o.push(i[s].x,i[s].y,i[s].z),o.push(i[e].x,i[e].y,i[e].z),a.push(0,0,1),a.push(0,0,1),a.push(0,0,1),a.push(0,0,1),r.push(0,0,1,0,1,1,0,1);let h=4*e,p=h+1,l=h+2,u=h+3;n.push(h,p,l,l,u,h)}return{pos:o,normals:a,sts:r,indices:n}}addHeight(t,e){let s=e||0;if(t.hasOwnProperty("height"))return t.height+=s,t;{let e=r.Cartographic.fromCartesian(t);return e.height+=s,r.Cartographic.toCartesian(e)}}}}));
