import{g as m,e as A,U as b,a as N,b as f,F as z,u as U,l as D,E as I,c as Y,d as k,f as H,G as h,h as J,i as X,j as V,k as v,m as B,P as j,L as W,n as $,o as K,p as q,q as Q,I as _,r as F,s as Z,t as tt,v as S,w as et,x as rt,y as nt,V as it,z as ot,S as E,A as at}from"./MapOl-25671793.js";var st=function(){function i(){this.dataProjection=null,this.defaultFeatureProjection=null}return i.prototype.getReadOptions=function(r,t){var e;if(t){var n=t.dataProjection?m(t.dataProjection):this.readProjection(r);t.extent&&n&&n.getUnits()===b.TILE_PIXELS&&(n=m(n),n.setWorldExtent(t.extent)),e={dataProjection:n,featureProjection:t.featureProjection}}return this.adaptOptions(e)},i.prototype.adaptOptions=function(r){return N({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},r)},i.prototype.getType=function(){return f()},i.prototype.readFeature=function(r,t){return f()},i.prototype.readFeatures=function(r,t){return f()},i.prototype.readGeometry=function(r,t){return f()},i.prototype.readProjection=function(r){return f()},i.prototype.writeFeature=function(r,t){return f()},i.prototype.writeFeatures=function(r,t){return f()},i.prototype.writeGeometry=function(r,t){return f()},i}();function C(i,r,t){var e=t?m(t.featureProjection):null,n=t?m(t.dataProjection):null,o;if(e&&n&&!A(e,n)?o=(r?i.clone():i).transform(r?e:n,r?n:e):o=i,r&&t&&t.decimals!==void 0){var a=Math.pow(10,t.decimals),c=function(s){for(var u=0,l=s.length;u<l;++u)s[u]=Math.round(s[u]*a)/a;return s};o===i&&(o=i.clone()),o.applyTransform(c)}return o}var ct=globalThis&&globalThis.__extends||function(){var i=function(r,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])},i(r,t)};return function(r,t){i(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ut=function(i){ct(r,i);function r(){return i.call(this)||this}return r.prototype.getType=function(){return z.JSON},r.prototype.readFeature=function(t,e){return this.readFeatureFromObject(O(t),this.getReadOptions(t,e))},r.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(O(t),this.getReadOptions(t,e))},r.prototype.readFeatureFromObject=function(t,e){return f()},r.prototype.readFeaturesFromObject=function(t,e){return f()},r.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(O(t),this.getReadOptions(t,e))},r.prototype.readGeometryFromObject=function(t,e){return f()},r.prototype.readProjection=function(t){return this.readProjectionFromObject(O(t))},r.prototype.readProjectionFromObject=function(t){return f()},r.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},r.prototype.writeFeatureObject=function(t,e){return f()},r.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},r.prototype.writeFeaturesObject=function(t,e){return f()},r.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},r.prototype.writeGeometryObject=function(t,e){return f()},r}(st);function O(i){if(typeof i=="string"){var r=JSON.parse(i);return r||null}else return i!==null?i:null}const ht=ut;var ft=globalThis&&globalThis.__extends||function(){var i=function(r,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])},i(r,t)};return function(r,t){i(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),lt=function(i){ft(r,i);function r(t){var e=i.call(this)||this;return e.geometries_=t||null,e.changeEventsKeys_=[],e.listenGeometriesChange_(),e}return r.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(U),this.changeEventsKeys_.length=0},r.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(D(this.geometries_[t],I.CHANGE,this.changed,this))},r.prototype.clone=function(){var t=new r(null);return t.setGeometries(this.geometries_),t},r.prototype.closestPointXY=function(t,e,n,o){if(o<Y(this.getExtent(),t,e))return o;for(var a=this.geometries_,c=0,s=a.length;c<s;++c)o=a[c].closestPointXY(t,e,n,o);return o},r.prototype.containsXY=function(t,e){for(var n=this.geometries_,o=0,a=n.length;o<a;++o)if(n[o].containsXY(t,e))return!0;return!1},r.prototype.computeExtent=function(t){k(t);for(var e=this.geometries_,n=0,o=e.length;n<o;++n)H(t,e[n].getExtent());return t},r.prototype.getGeometries=function(){return L(this.geometries_)},r.prototype.getGeometriesArray=function(){return this.geometries_},r.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var e=[],n=this.geometries_,o=!1,a=0,c=n.length;a<c;++a){var s=n[a],u=s.getSimplifiedGeometry(t);e.push(u),u!==s&&(o=!0)}if(o){var l=new r(null);return l.setGeometriesArray(e),l}else return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},r.prototype.getType=function(){return h.GEOMETRY_COLLECTION},r.prototype.intersectsExtent=function(t){for(var e=this.geometries_,n=0,o=e.length;n<o;++n)if(e[n].intersectsExtent(t))return!0;return!1},r.prototype.isEmpty=function(){return this.geometries_.length===0},r.prototype.rotate=function(t,e){for(var n=this.geometries_,o=0,a=n.length;o<a;++o)n[o].rotate(t,e);this.changed()},r.prototype.scale=function(t,e,n){var o=n;o||(o=J(this.getExtent()));for(var a=this.geometries_,c=0,s=a.length;c<s;++c)a[c].scale(t,e,o);this.changed()},r.prototype.setGeometries=function(t){this.setGeometriesArray(L(t))},r.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},r.prototype.applyTransform=function(t){for(var e=this.geometries_,n=0,o=e.length;n<o;++n)e[n].applyTransform(t);this.changed()},r.prototype.translate=function(t,e){for(var n=this.geometries_,o=0,a=n.length;o<a;++o)n[o].translate(t,e);this.changed()},r.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),i.prototype.disposeInternal.call(this)},r}(X);function L(i){for(var r=[],t=0,e=i.length;t<e;++t)r.push(i[t].clone());return r}const gt=lt;var pt=globalThis&&globalThis.__extends||function(){var i=function(r,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])},i(r,t)};return function(r,t){i(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),_t=function(i){pt(r,i);function r(t){var e=this,n=t||{};return e=i.call(this)||this,e.dataProjection=m(n.dataProjection?n.dataProjection:"EPSG:4326"),n.featureProjection&&(e.defaultFeatureProjection=m(n.featureProjection)),e.geometryName_=n.geometryName,e.extractGeometryName_=n.extractGeometryName,e}return r.prototype.readFeatureFromObject=function(t,e){var n=null;t.type==="Feature"?n=t:n={type:"Feature",geometry:t,properties:null};var o=G(n.geometry,e),a=new V;return this.geometryName_?a.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in n!==void 0&&a.setGeometryName(n.geometry_name),a.setGeometry(o),"id"in n&&a.setId(n.id),n.properties&&a.setProperties(n.properties,!0),a},r.prototype.readFeaturesFromObject=function(t,e){var n=t,o=null;if(n.type==="FeatureCollection"){var a=t;o=[];for(var c=a.features,s=0,u=c.length;s<u;++s)o.push(this.readFeatureFromObject(c[s],e))}else o=[this.readFeatureFromObject(t,e)];return o},r.prototype.readGeometryFromObject=function(t,e){return G(t,e)},r.prototype.readProjectionFromObject=function(t){var e=t.crs,n;return e?e.type=="name"?n=m(e.properties.name):v(!1,36):n=this.dataProjection,n},r.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var n={type:"Feature",geometry:null,properties:null},o=t.getId();o!==void 0&&(n.id=o);var a=t.getGeometry();a&&(n.geometry=T(a,e));var c=t.getProperties();return delete c[t.getGeometryName()],B(c)||(n.properties=c),n},r.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var n=[],o=0,a=t.length;o<a;++o)n.push(this.writeFeatureObject(t[o],e));return{type:"FeatureCollection",features:n}},r.prototype.writeGeometryObject=function(t,e){return T(t,this.adaptOptions(e))},r}(ht);function G(i,r){if(!i)return null;var t;switch(i.type){case h.POINT:{t=yt(i);break}case h.LINE_STRING:{t=dt(i);break}case h.POLYGON:{t=Gt(i);break}case h.MULTI_POINT:{t=vt(i);break}case h.MULTI_LINE_STRING:{t=Ot(i);break}case h.MULTI_POLYGON:{t=It(i);break}case h.GEOMETRY_COLLECTION:{t=mt(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return C(t,!1,r)}function mt(i,r){var t=i.geometries.map(function(e){return G(e,r)});return new gt(t)}function yt(i){return new j(i.coordinates)}function dt(i){return new W(i.coordinates)}function Ot(i){return new $(i.coordinates)}function vt(i){return new K(i.coordinates)}function It(i){return new q(i.coordinates)}function Gt(i){return new Q(i.coordinates)}function T(i,r){i=C(i,!0,r);var t=i.getType(),e;switch(t){case h.POINT:{e=Et(i);break}case h.LINE_STRING:{e=Pt(i);break}case h.POLYGON:{e=Lt(i,r);break}case h.MULTI_POINT:{e=Ft(i);break}case h.MULTI_LINE_STRING:{e=wt(i);break}case h.MULTI_POLYGON:{e=St(i,r);break}case h.GEOMETRY_COLLECTION:{e=Tt(i,r);break}case h.CIRCLE:{e={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return e}function Tt(i,r){var t=i.getGeometriesArray().map(function(e){var n=N({},r);return delete n.featureProjection,T(e,n)});return{type:"GeometryCollection",geometries:t}}function Pt(i,r){return{type:"LineString",coordinates:i.getCoordinates()}}function wt(i,r){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function Ft(i,r){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function St(i,r){var t;return r&&(t=r.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(t)}}function Et(i,r){return{type:"Point",coordinates:i.getCoordinates()}}function Lt(i,r){var t;return r&&(t=r.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(t)}}const Nt=_t,y={FRACTION:"fraction",PIXELS:"pixels"};var jt=globalThis&&globalThis.__extends||function(){var i=function(r,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])},i(r,t)};return function(r,t){i(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ct=function(i){jt(r,i);function r(t,e,n,o,a,c){var s=i.call(this)||this;return s.hitDetectionImage_=null,s.image_=t||new Image,o!==null&&(s.image_.crossOrigin=o),s.canvas_=c?document.createElement("canvas"):null,s.color_=c,s.unlisten_=null,s.imageState_=a,s.size_=n,s.src_=e,s.tainted_,s}return r.prototype.isTainted_=function(){if(this.tainted_===void 0&&this.imageState_===_.LOADED){this.tainted_=!1;var t=F(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch{this.tainted_=!0}}return this.tainted_===!0},r.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(I.CHANGE)},r.prototype.handleImageError_=function(){this.imageState_=_.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},r.prototype.handleImageLoad_=function(){this.imageState_=_.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},r.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},r.prototype.getImageState=function(){return this.imageState_},r.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],n=this.size_[1],o=F(e,n);o.fillRect(0,0,e,n),this.hitDetectionImage_=o.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},r.prototype.getSize=function(){return this.size_},r.prototype.getSrc=function(){return this.src_},r.prototype.load=function(){if(this.imageState_==_.IDLE){this.imageState_=_.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=Z(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},r.prototype.replaceColor_=function(){if(!(!this.color_||this.isTainted_())){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),n=e.data,o=this.color_[0]/255,a=this.color_[1]/255,c=this.color_[2]/255,s=0,u=n.length;s<u;s+=4)n[s]*=o,n[s+1]*=a,n[s+2]*=c;t.putImageData(e,0,0)}},r.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},r}(tt);function Mt(i,r,t,e,n,o){var a=S.get(r,e,o);return a||(a=new Ct(i,r,t,e,n,o),S.set(r,e,o,a)),a}const g={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};var Rt=globalThis&&globalThis.__extends||function(){var i=function(r,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])},i(r,t)};return function(r,t){i(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),xt=function(i){Rt(r,i);function r(t){var e=this,n=t||{},o=n.opacity!==void 0?n.opacity:1,a=n.rotation!==void 0?n.rotation:0,c=n.scale!==void 0?n.scale:1,s=n.rotateWithView!==void 0?n.rotateWithView:!1;e=i.call(this,{opacity:o,rotation:a,scale:c,rotateWithView:s})||this,e.anchor_=n.anchor!==void 0?n.anchor:[.5,.5],e.normalizedAnchor_=null,e.anchorOrigin_=n.anchorOrigin!==void 0?n.anchorOrigin:g.TOP_LEFT,e.anchorXUnits_=n.anchorXUnits!==void 0?n.anchorXUnits:y.FRACTION,e.anchorYUnits_=n.anchorYUnits!==void 0?n.anchorYUnits:y.FRACTION,e.crossOrigin_=n.crossOrigin!==void 0?n.crossOrigin:null;var u=n.img!==void 0?n.img:null,l=n.imgSize!==void 0?n.imgSize:null,p=n.src;v(!(p!==void 0&&u),4),v(!u||u&&l,5),(p===void 0||p.length===0)&&u&&(p=u.src||et(u)),v(p!==void 0&&p.length>0,6);var d=n.src!==void 0?_.IDLE:_.LOADED;return e.color_=n.color!==void 0?rt(n.color):null,e.iconImage_=Mt(u,p,l,e.crossOrigin_,d,e.color_),e.offset_=n.offset!==void 0?n.offset:[0,0],e.offsetOrigin_=n.offsetOrigin!==void 0?n.offsetOrigin:g.TOP_LEFT,e.origin_=null,e.size_=n.size!==void 0?n.size:null,e}return r.prototype.clone=function(){return new r({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:this.size_!==null?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},r.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==y.FRACTION||this.anchorYUnits_==y.FRACTION){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==y.FRACTION&&(t[0]*=e[0]),this.anchorYUnits_==y.FRACTION&&(t[1]*=e[1])}if(this.anchorOrigin_!=g.TOP_LEFT){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_==g.TOP_RIGHT||this.anchorOrigin_==g.BOTTOM_RIGHT)&&(t[0]=-t[0]+e[0]),(this.anchorOrigin_==g.BOTTOM_LEFT||this.anchorOrigin_==g.BOTTOM_RIGHT)&&(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},r.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},r.prototype.getColor=function(){return this.color_},r.prototype.getImage=function(t){return this.iconImage_.getImage(t)},r.prototype.getImageSize=function(){return this.iconImage_.getSize()},r.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},r.prototype.getImageState=function(){return this.iconImage_.getImageState()},r.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},r.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=g.TOP_LEFT){var e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),(this.offsetOrigin_==g.TOP_RIGHT||this.offsetOrigin_==g.BOTTOM_RIGHT)&&(t[0]=n[0]-e[0]-t[0]),(this.offsetOrigin_==g.BOTTOM_LEFT||this.offsetOrigin_==g.BOTTOM_RIGHT)&&(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_},r.prototype.getSrc=function(){return this.iconImage_.getSrc()},r.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},r.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(I.CHANGE,t)},r.prototype.load=function(){this.iconImage_.load()},r.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(I.CHANGE,t)},r}(nt);const At=xt,Ut={type:"Feature",geometry:{type:"LineString",coordinates:[[116.5023829401775,40.06522477724008],[116.56966673559397,39.97962817138796],[116.70768232963108,39.979043045514935],[116.64950019667214,40.06847409330681],[116.72513159378437,40.092892082590886],[116.65182112663491,40.11754844261]]}};function bt(i,r){let t=i.getGeometry(),e=t.getLength(),n=100*r/e,o=1e4,a=[new E({stroke:new at({color:"green",width:10})})];for(let c=0;c<=1;c+=n){let s=t.getCoordinateAt(c);t.forEachSegment(function(u,l){if(u[0]==l[0]||u[1]==l[1])return;let p=l[0]-s[0],d=l[1]-s[1],P=s[0]-u[0],w=s[1]-u[1];if(p!=P&&d!=w&&Math.abs(o*p*w-o*P*d)<.001){let M=l[0]-u[0],R=l[1]-u[1],x=Math.atan2(R,M);a.push(new E({geometry:new j(s),image:new At({src:"arrow",anchor:[.5,.5],rotateWithView:!1,rotation:-x+Math.PI*3/2})}))}})}return a}function Dt(i){let r=new Nt({geometryName:"line"}).readFeature(i.geometry);return new it({source:new ot({features:[r]}),style:bt})}export{Dt as a,Ut as r};
