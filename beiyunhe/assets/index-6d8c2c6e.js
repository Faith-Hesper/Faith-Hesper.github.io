import{_ as T,f as F,s as I,r,o as v,v as G,w as n,a,t as x,b as t,x as l,u as J,c as w,F as L,i as R,D as P}from"./index-267246aa.js";import{i as A}from"./inspect-56f7f76f.js";import{i as K,j as Q}from"./atentionAPI-698fbc9c.js";import{u as W}from"./useOperate-2feed5ad.js";import"./axios-da025460.js";import"./index-1899286b.js";const X={class:"title"},Z={__name:"DetailModal",props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},data:{default:{plan:"",content:"",userName:"",date:""}},onSubmit:{default:()=>{}}},emits:["update:visible"],setup(D,{emit:C}){const p=D,S=C,m=F(),f=I(()=>p.visible),i=I(()=>p.data);function V(){S("update:visible",!1)}function h(){m.value.validate(g=>{if(g)p.onSubmit(l(i));else return console.log("error submit!!"),!1})}return(g,u)=>{const b=r("el-input"),_=r("el-form-item"),N=r("el-date-picker"),y=r("el-form"),Y=r("el-dialog");return v(),G(Y,{modelValue:f.value,"onUpdate:modelValue":u[4]||(u[4]=s=>f.value=s),"before-close":V,class:"custom-dialog","append-to-body":!0,width:"30%"},{header:n(()=>[a("div",X,x(D.title),1)]),footer:n(()=>[a("div",{class:"dialog-footer flex content-center"},[a("div",{class:"reset-btn",onClick:V},"取 消"),a("div",{class:"search-btn",type:"primary",onClick:h},"确 定")])]),default:n(()=>[t(y,{model:i.value,"label-width":"auto","label-position":"left",ref_key:"formRef",ref:m,class:"custom-form"},{default:n(()=>[t(_,{label:"养护计划名称",prop:"name",required:""},{default:n(()=>[t(b,{class:"custom-input",modelValue:i.value.name,"onUpdate:modelValue":u[0]||(u[0]=s=>i.value.name=s)},null,8,["modelValue"])]),_:1}),t(_,{label:"养护内容",prop:"content"},{default:n(()=>[t(b,{class:"custom-input",modelValue:i.value.content,"onUpdate:modelValue":u[1]||(u[1]=s=>i.value.content=s)},null,8,["modelValue"])]),_:1}),t(_,{label:"养护人员",prop:"userName"},{default:n(()=>[t(b,{class:"custom-input",modelValue:i.value.userName,"onUpdate:modelValue":u[2]||(u[2]=s=>i.value.userName=s)},null,8,["modelValue"])]),_:1}),t(_,{label:"养护日期",prop:"time"},{default:n(()=>[t(N,{type:"date",class:"custom-input","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:i.value.time,"onUpdate:modelValue":u[3]||(u[3]=s=>i.value.time=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},ee=T(Z,[["__scopeId","data-v-ae6c9cc7"]]);const te={class:"header"},le={class:"right"},oe={class:"title"},ae={class:"num"},ne={class:"control"},se={class:"searchBar-btns"},ie={class:"table"},ue=["onClick","src"],re={class:"table-page"},de={__name:"index",setup(D){const C={get:K},{page:p,formRef:S,formData:m,dialogVis:f,dialogData:i,tableData:V,onSearch:h,resetForm:g,onSubmit:u,handleSizeChange:b,handleCurrentChange:_}=W({operationMap:C});new Date().getFullYear().toString(),new Date().getMonth()-1;const N=J(),y=[{title:"待养护",num:"578",unit:"个"},{title:"逾期未养护",num:"578",unit:"个"},{title:"已养护",num:"578",unit:"个"}],Y=[{prop:"time",label:"养护日期"},{prop:"name",label:"养护任务名称"},{prop:"userName",label:"养护人员"},{prop:"content",label:"养护设备"}],s=F(y);function $(d){return{color:""+{待养护:"#19deff",逾期未养护:"#ffc002",已养护:"#19ffa1"}[d]}}function U(d){return["待养护","已养护","逾期未养护"][d]}async function j(){try{const{code:d,data:o}=await Q();d===1&&(s.value=y.map(c=>(c.title==="待养护"&&(c.num=o.toBeNum),c.title==="逾期未养护"&&(c.num=o.beLateNum),c.title==="已养护"&&(c.num=o.comNum),c)),console.log(s.value))}catch(d){console.error("获取数据失败",d)}}j();function q(d){localStorage.setItem("tableData",JSON.stringify(d)),N.push({path:"/patrolGuard/atentionDetail",query:{id:d.id,back:"atentionTask"}})}return(d,o)=>{const c=r("el-date-picker"),M=r("el-form-item"),z=r("el-input"),H=r("el-form"),k=r("el-table-column"),O=r("el-table"),E=r("el-pagination");return v(),w("div",null,[a("div",te,[(v(!0),w(L,null,R(s.value,e=>(v(),w("div",{class:"panel",key:e.title},[a("div",le,[a("div",oe,x(e.title),1),a("div",ae,x(e.num+e.unit),1)])]))),128))]),a("div",ne,[t(H,{inline:!0,model:l(m),"label-width":"auto","label-position":"left",ref_key:"formRef",ref:S,class:"custom-form"},{default:n(()=>[t(M,{label:"日期",prop:"time"},{default:n(()=>[t(c,{style:{width:"185px"},modelValue:l(m).time,"onUpdate:modelValue":o[0]||(o[0]=e=>l(m).time=e),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","popper-class":"custom-select",type:"date"},null,8,["modelValue"])]),_:1}),t(M,{label:"任务名称",prop:"name"},{default:n(()=>[t(z,{class:"custom-input",modelValue:l(m).name,"onUpdate:modelValue":o[1]||(o[1]=e=>l(m).name=e)},null,8,["modelValue"])]),_:1}),t(M,{label:"养护人员",prop:"userName"},{default:n(()=>[t(z,{class:"custom-input",modelValue:l(m).userName,"onUpdate:modelValue":o[2]||(o[2]=e=>l(m).userName=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a("div",se,[a("div",{class:"reset-btn",onClick:o[3]||(o[3]=(...e)=>l(g)&&l(g)(...e))},"重置"),a("div",{class:"search-btn",onClick:o[4]||(o[4]=(...e)=>l(h)&&l(h)(...e))},"查询")])]),a("div",ie,[t(O,{data:l(V),class:"custom-table deep","highlight-current-row":""},{default:n(()=>[t(k,{type:"index",label:"序号",align:"center",width:"70"}),(v(),w(L,null,R(Y,(e,B)=>t(k,{key:B,prop:e.prop,label:e.label,width:e.width,align:"center","show-overflow-tooltip":""},null,8,["prop","label","width"])),64)),t(k,{label:"状态",align:"center",width:"120"},{default:n(e=>[a("div",{class:"tag",style:P($(U(e.row.status)))},x(U(e.row.status)),5)]),_:1}),t(k,{label:"操作",align:"center",width:"180"},{default:n(e=>[a("img",{class:"img",title:"详情",onClick:B=>q(e.row),src:l(A)},null,8,ue)]),_:1})]),_:1},8,["data"]),a("div",re,[t(E,{class:"custom-pagination",onSizeChange:l(b),onCurrentChange:l(_),"current-page":l(p).pageNum,"page-size":l(p).pageSize,layout:"total, prev, pager, next, jumper",total:l(p).total,background:""},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])]),t(ee,{visible:l(f),title:"养护任务",data:l(i),onSubmit:l(u),"onUpdate:visible":o[5]||(o[5]=e=>f.value=e)},null,8,["visible","data","onSubmit"])])}}},be=T(de,[["__scopeId","data-v-a71cc801"]]);export{be as default};
