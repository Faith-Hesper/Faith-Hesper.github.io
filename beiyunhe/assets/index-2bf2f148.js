import{_ as K}from"./zdjh-bc3a60d2.js";import{_ as Q}from"./fb-65ca9f77.js";import{_ as A,J as W,f as P,s as I,r as i,o as f,v as T,w as o,a as s,t as q,b as l,c as x,i as R,F,x as a,u as X,D as Z,d as z,C as ee}from"./index-79e36b83.js";import{g as te}from"./securityManagementAPI-a9030ac0.js";import"./axios-c0524c3b.js";import{a as le}from"./systemAPI-159b07b8.js";import{D as ae}from"./DialogView-54d1109d.js";import{c as oe,d as ne,e as re,f as se,h as ie}from"./atentionAPI-c7a0c66e.js";import{u as ue}from"./useOperate-754ac797.js";import"./index-b0dc9d9c.js";const de={class:"title"},me={__name:"DetailModal",props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},data:{default:{name:"",content:"",userName:"",time:""}},onSubmit:{default:()=>{}}},emits:["update:visible"],setup(O,{emit:L}){const _=O,$=L,c=W({total:20,pageNum:1,pageSize:20}),y=P([]),b=P([]),w=P(),k=I(()=>_.visible),m=I(()=>_.data);async function S(){const u=await h("point",window.config.dictObject.DeviceType);u&&(y.value=u)}S();async function N(){const u=await h("user",{current:c.pageNum,size:c.pageSize});u&&(b.value=u.records)}N();async function h(u,n){const D={point:le,user:te};try{const d=D[u],{code:V,data:g}=await d(n);return V===1?g:!1}catch(d){return console.error(`${u}操作失败`,d),!1}}function U(){$("update:visible",!1)}function B(){w.value.validate(u=>{if(u){let n=a(m);Array.isArray(n.content)&&(n.content=n.content.join("、")),_.onSubmit(a(n))}else return console.log("error submit!!"),!1})}return(u,n)=>{const D=i("el-input"),d=i("el-form-item"),V=i("el-option"),g=i("el-select"),v=i("el-date-picker"),p=i("el-form"),e=i("el-dialog");return f(),T(e,{modelValue:k.value,"onUpdate:modelValue":n[4]||(n[4]=r=>k.value=r),"before-close":U,class:"custom-dialog","append-to-body":!0,width:"30%"},{header:o(()=>[s("div",de,q(O.title),1)]),footer:o(()=>[s("div",{class:"dialog-footer flex content-center"},[s("div",{class:"reset-btn",onClick:U},"取 消"),s("div",{class:"search-btn",type:"primary",onClick:B},"确 定")])]),default:o(()=>[l(p,{model:m.value,"label-width":"auto","label-position":"left",ref_key:"formRef",ref:w,class:"custom-form"},{default:o(()=>[l(d,{label:"养护计划名称",prop:"name",error:"请输入养护计划名称",required:""},{default:o(()=>[l(D,{class:"custom-input",modelValue:m.value.name,"onUpdate:modelValue":n[0]||(n[0]=r=>m.value.name=r)},null,8,["modelValue"])]),_:1}),l(d,{label:"养护设备",prop:"content",error:"请输入养护设备信息",required:""},{default:o(()=>[l(g,{modelValue:m.value.content,"onUpdate:modelValue":n[1]||(n[1]=r=>m.value.content=r)},{default:o(()=>[(f(!0),x(F,null,R(y.value,r=>(f(),T(V,{key:r.dictValue,label:r.dictLabel,value:r.dictLabel},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"养护人员",prop:"userName",error:"请输入养护人员信息",required:""},{default:o(()=>[l(g,{modelValue:m.value.userName,"onUpdate:modelValue":n[2]||(n[2]=r=>m.value.userName=r)},{default:o(()=>[(f(!0),x(F,null,R(b.value,r=>(f(),T(V,{label:r.name,value:r.name,key:r.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"养护日期",prop:"time",error:"请输入养护日期",required:""},{default:o(()=>[l(v,{style:{width:"100%"},modelValue:m.value.time,"onUpdate:modelValue":n[3]||(n[3]=r=>m.value.time=r),"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},pe=A(me,[["__scopeId","data-v-4c1cf902"]]);const ce={class:"control"},fe={class:"searchBar-btns"},_e={class:"table"},be={class:"table-cell"},ge={class:"table-page"},ve={class:"upload"},ye={key:0,src:Q,alt:"",srcset:""},ke={__name:"index",setup(O){const L={get:oe,create:ne,edit:re,upload:se,delete:ie},{page:_,formRef:$,formData:c,dialogVis:y,tmpDialogVis:b,curOperation:w,dialogData:k,tableData:m,onSearch:S,resetForm:N,onSubmit:h,onUpdate:U,handleSizeChange:B,handleCurrentChange:u}=ue({operationMap:L});new Date().getFullYear().toString(),new Date().getMonth()-1;const n=X(),D=[{prop:"time",label:"养护日期"},{prop:"name",label:"养护计划名称",width:"120px"},{prop:"userName",label:"养护人员"},{prop:"content",label:"养护设备"}],d=P("发布");function V(p){return{color:""+{待发布:"#19deff",未发布:"#ffc002",已发布:"#19ffa1"}[p]}}function g(p){return["待发布","已发布","未发布"][p]}function v(p,e){switch(w.value=e,console.log(e,JSON.parse(JSON.stringify(p)),k),k.value=JSON.parse(JSON.stringify(p)),e){case"detail":localStorage.setItem("tableData",JSON.stringify(p)),n.push({path:"/patrolGuard/atentionDetail",query:{id:p.id,back:"atentionPlan"}});break;case"upload":d.value="发布",b.value=!0;break;case"delete":d.value="删除",b.value=!0;break;default:y.value=!0}}return(p,e)=>{const r=i("el-date-picker"),J=i("el-form-item"),j=i("el-input"),H=i("el-form"),Y=i("el-table-column"),M=i("el-button"),E=i("el-table"),G=i("el-pagination");return f(),x("div",null,[s("div",ce,[l(H,{inline:!0,model:a(c),"label-width":"auto","label-position":"left",ref_key:"formRef",ref:$,class:"custom-form"},{default:o(()=>[l(J,{label:"日期",prop:"time"},{default:o(()=>[l(r,{style:{width:"185px"},modelValue:a(c).time,"onUpdate:modelValue":e[0]||(e[0]=t=>a(c).time=t),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","popper-class":"custom-select",type:"date"},null,8,["modelValue"])]),_:1}),l(J,{label:"计划名称",prop:"name"},{default:o(()=>[l(j,{class:"custom-input",modelValue:a(c).name,"onUpdate:modelValue":e[1]||(e[1]=t=>a(c).name=t)},null,8,["modelValue"])]),_:1}),l(J,{label:"养护人员",prop:"userName"},{default:o(()=>[l(j,{class:"custom-input",modelValue:a(c).userName,"onUpdate:modelValue":e[2]||(e[2]=t=>a(c).userName=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("div",fe,[s("div",{class:"reset-btn",onClick:e[3]||(e[3]=(...t)=>a(N)&&a(N)(...t))},"重置"),s("div",{class:"search-btn",onClick:e[4]||(e[4]=(...t)=>a(S)&&a(S)(...t))},"查询")]),s("div",{class:"plan",onClick:e[5]||(e[5]=t=>v({},"create"))},e[8]||(e[8]=[s("img",{src:K,alt:""},null,-1),s("span",{class:"text"},"制定养护计划",-1)]))]),s("div",_e,[l(E,{data:a(m),class:"custom-table deep","max-height":"700","highlight-current-row":""},{default:o(()=>[l(Y,{type:"index",label:"序号",align:"center",width:"70"}),(f(),x(F,null,R(D,(t,C)=>l(Y,{key:C,prop:t.prop,label:t.label,width:t.width,align:"center","show-overflow-tooltip":""},null,8,["prop","label","width"])),64)),l(Y,{label:"状态",align:"center",width:"120"},{default:o(t=>[s("div",{class:"tag",style:Z(V(g(t.row.status)))},q(g(t.row.status)),5)]),_:1}),l(Y,{label:"操作",align:"center",width:"180"},{default:o(t=>[s("div",be,[l(M,{type:"primary",text:"primary",onClick:C=>v(t.row,"edit"),link:"",disabled:t.row.status},{default:o(()=>e[9]||(e[9]=[z("编辑")])),_:2},1032,["onClick","disabled"]),l(M,{type:"primary",text:"primary",onClick:C=>v(t.row,"detail"),link:""},{default:o(()=>e[10]||(e[10]=[z("详情")])),_:2},1032,["onClick"]),l(M,{type:"primary",text:"primary",onClick:C=>v(t.row,"upload"),link:"",disabled:t.row.status},{default:o(()=>e[11]||(e[11]=[z("发布")])),_:2},1032,["onClick","disabled"]),l(M,{type:"danger",text:"danger",onClick:C=>v(t.row,"delete"),link:"",disabled:t.row.status},{default:o(()=>e[12]||(e[12]=[z("删除")])),_:2},1032,["onClick","disabled"])])]),_:1})]),_:1},8,["data"]),s("div",ge,[l(G,{class:"custom-pagination",onSizeChange:a(B),onCurrentChange:a(u),"current-page":a(_).pageNum,"page-size":a(_).pageSize,layout:"total, prev, pager, next, jumper",total:a(_).total,background:""},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])]),l(pe,{visible:a(y),title:"养护计划",data:a(k),onSubmit:a(U),"onUpdate:visible":e[6]||(e[6]=t=>y.value=t)},null,8,["visible","data","onSubmit"]),l(ae,{visible:a(b),title:d.value,onSubmit:a(h),"onUpdate:visible":e[7]||(e[7]=t=>b.value=t)},{default:o(()=>[s("div",ve,[a(w)==="upload"?(f(),x("img",ye)):ee("",!0),s("span",null,"请确认，是否"+q(d.value)+"此任务",1)])]),_:1},8,["visible","title","onSubmit"])])}}},Me=A(ke,[["__scopeId","data-v-9fb0262a"]]);export{Me as default};
