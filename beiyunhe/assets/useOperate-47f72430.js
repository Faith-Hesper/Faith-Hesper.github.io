import{f as r,J as m,x as L}from"./index-79e36b83.js";const u=()=>{},M={total:20,pageNum:1,pageSize:10},P={name:"",time:"",userName:""},h={get:u,create:u,edit:u,upload:u,delete:u},R="create";function C({form:v=P,pageData:I=M,operation:N=R,operationMap:l=h}){const f=r(),d=m({...v}),n=m({...I}),s=r(N),O={...h,...l},p=r([]),c=r({}),i=r(!1),T=r(!1);async function o(){try{const e=O.get,{code:a,data:t}=await e({current:n.pageNum,size:n.pageSize,...d});a===1&&(n.total=t.total,p.value=t.records)}catch(e){console.error("获取数据失败",e)}}async function g(e,a){try{const t=l[e],{code:F}=await t(a);return F===1?(await o(),!0):!1}catch(t){return console.error(`${e}操作失败`,t),!1}}function A(e){if(e==null)return!0;for(let a in e)if(Object.hasOwn(e,a)){const t=e[a];if(t==null||t==="")return!0}return!1}function D(e){console.log(c.value,c.value.valueOf(),s.value);const a=s.value==="create"?"create":"edit",t=L(c);A(t)||(g(a,t),i.value=!1)}function E(){const e=c.value,a=s.value==="upload"?"upload":"delete";g(a,e),i.value=!1}function w(){n.pageNum=1,o()}function y(e){n.pageSize=e,o()}function S(e){n.pageNum=e,o()}function z(){f.value.resetFields()}return o(),{formRef:f,formData:d,tableData:p,dialogVis:i,dialogData:c,curOperation:s,tmpDialogVis:T,page:n,fetchData:o,onUpdate:D,onSubmit:E,onSearch:w,resetForm:z,handleSizeChange:y,handleCurrentChange:S}}export{C as u};
