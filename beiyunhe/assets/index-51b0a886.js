import{_ as ie}from"./close_icon-79cdeb99.js";import{_ as pe,u as ce,f as i,J as j,g as me,r as p,o as u,c as m,a as n,b as l,w as a,C as E,x as ve,v,A as F,F as b,i as _,K as be,n as _e,t as ge}from"./index-267246aa.js";import{d as fe}from"./dialogRemoveCom-acb7236a.js";import{g as Ve,d as ye,s as he}from"./engineeringAPI-b1b8a18c.js";import{g as ke,a as M}from"./systemAPI-88b64bb8.js";import{s as Y}from"./unit-ac192840.js";import"./axios-da025460.js";const Ce={class:"ledger"},Te={class:"top"},we={class:"search"},De={class:"table"},qe=["onClick"],Ue=["onClick"],xe=["onClick"],Le={key:0,class:"add"},Oe={class:"content"},Ne={class:"main"},Re={__name:"index",setup(Be){const w=ce(),D=window.config,r=i({name:"",assetType:"",deviceType:"",status:"",current:1,size:20}),B=i(0),o=j({assetNumber:"",name:"",relate_stcd:"",assetType:"",deviceType:"",buildDate:"",constructionPoint:"",brand:"",status:"",inCharge:""}),J=j({assetNumber:[{required:!0,message:"请输入资产编号",trigger:"blur"}],name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],relate_stcd:[{required:!0,message:"请选择资产应用",trigger:"change"}],assetType:[{required:!0,message:"请选择资产类型",trigger:"change"}],deviceType:[{required:!0,message:"请选择设备设施类型",trigger:"change"}],buildDate:[{type:"date",required:!0,message:"请选择建设时间",trigger:"change"}],constructionPoint:[{required:!0,message:"请输入安装位置",trigger:"blur"}],brand:[{required:!0,message:"请输入设备品牌",trigger:"blur"}],status:[{required:!0,message:"请选择设备设施状态",trigger:"change"}],inCharge:[{required:!0,message:"请输入负责人",trigger:"blur"}]}),q=i(null);let C=i(!1);const U=i(!1),x=i({});i("");const $=i([{label:"资产编号",prop:"assetNumber"},{label:"设备名称",prop:"name"},{label:"资产应用",prop:"relateStcdZh"},{label:"资产类型",prop:"assetTypeZh"},{label:"设备设施类型",prop:"deviceTypeZh"},{label:"建设时间",prop:"buildDate"},{label:"位置",prop:"constructionPoint"},{label:"设备实施品牌",prop:"brand"},{label:"设备设施状态",prop:"statusZh"},{label:"责任人",prop:"inCharge"}]),z=i([]),I=()=>{V()},H=()=>{for(let s in r.value)r.value[s]="";r.value.current=1,r.value.size=20,V()},K=s=>{Y("equipmentObject",JSON.stringify(s)),w.push({path:"/engineering/ledger/edit",query:{type:1}})},G=s=>{Y("equipmentObject",JSON.stringify(s)),w.push({path:"/engineering/ledger/child",query:{type:2}})},Q=()=>{U.value=!0},W=s=>{s.removeText=s.name,x.value=s,C.value=!0},X=()=>{C.value=!1},ee=()=>{ye(x.value.id).then(s=>{C.value=!1,V(),F({message:s.msg,type:"success"})})},L=()=>{U.value=!1,q.value.resetFields()},le=()=>{q.value.validate(s=>{s&&he(o).then(t=>{L(),V(),F({message:t.msg,type:"success"})})})},ae=()=>{w.push("/engineering/ledger/linkage")},h=i([]),S=i([]),A=i([]),O=i([]),P=i([]);me(()=>{V(),se()});const te=s=>{r.value.current=s,V()},V=()=>{Ve(r.value).then(s=>{console.log(s),z.value=s.data.list,B.value=s.data.total})},se=()=>{ke(D.dictObject.AssetType).then(s=>{console.log(s.data),h.value=s.data}),M(D.dictObject.DeviceStatus).then(s=>{O.value=s.data}),M(D.dictObject.DictZhaDescinfo).then(s=>{P.value=s.data})},oe=s=>{S.value=h.value.filter(t=>t.dictValue===s)[0].children,r.value.deviceType=""},ne=s=>{A.value=h.value.filter(t=>t.dictValue===s)[0].children,o.deviceType=""};return(s,t)=>{const y=p("el-input"),d=p("el-form-item"),g=p("el-option"),f=p("el-select"),Z=p("el-form"),N=p("el-table-column"),ue=p("el-table"),re=p("el-pagination"),c=p("el-col"),k=p("el-row"),de=p("el-date-picker");return u(),m("div",Ce,[n("div",Te,[n("div",we,[l(Z,{model:r.value,inline:""},{default:a(()=>[l(d,{label:"设备名称"},{default:a(()=>[l(y,{modelValue:r.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value.name=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),l(d,{label:"资产类型"},{default:a(()=>[l(f,{modelValue:r.value.assetType,"onUpdate:modelValue":t[1]||(t[1]=e=>r.value.assetType=e),onChange:oe},{default:a(()=>[(u(!0),m(b,null,_(h.value,e=>(u(),v(g,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"设备设施类型"},{default:a(()=>[l(f,{modelValue:r.value.deviceType,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value.deviceType=e)},{default:a(()=>[(u(!0),m(b,null,_(S.value,e=>(u(),v(g,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"设备设施状态"},{default:a(()=>[l(f,{modelValue:r.value.status,"onUpdate:modelValue":t[3]||(t[3]=e=>r.value.status=e)},{default:a(()=>[(u(!0),m(b,null,_(O.value,e=>(u(),v(g,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),n("div",{class:"search-btn",onClick:I},"查询"),n("div",{class:"reset-btn",onClick:H},"重置")]),n("div",{class:"bar"},[n("div",{class:"reset-btn",onClick:Q},"新建"),n("div",{class:"reset-btn",onClick:ae},"联动")])]),n("div",De,[l(ue,{data:z.value,height:"100%"},{default:a(()=>[l(N,{type:"index",width:"70",label:"序号",align:"center"}),(u(!0),m(b,null,_($.value,(e,T)=>(u(),v(N,{key:T,prop:e.prop,label:e.label,align:"center","show-overflow-tooltip":""},be({_:2},[e.prop=="statusZh"?{name:"default",fn:a(R=>[n("span",{class:_e(["status",{repair:R.row.status==1,broken:R.row.status==2}])},ge(R.row.statusZh),3)]),key:"0"}:void 0]),1032,["prop","label"]))),128)),l(N,{label:"操作",align:"center"},{default:a(e=>[n("span",{class:"oper-span oper-edit",onClick:T=>K(e.row)},"编辑",8,qe),n("span",{class:"oper-span oper-detail",onClick:T=>G(e.row)},"详情",8,Ue),n("span",{class:"oper-span oper-remove",onClick:T=>W(e.row)},"删除",8,xe)]),_:1})]),_:1},8,["data"])]),l(re,{class:"custom-pagination","current-page":r.value.current,"page-size":r.value.size,layout:"total, prev, pager, next, jumper",total:B.value,onCurrentChange:te},null,8,["current-page","page-size","total"]),U.value?(u(),m("div",Le,[n("div",Oe,[n("div",{class:"header"},[t[14]||(t[14]=n("div",{class:"title"},"新增",-1)),n("img",{src:ie,alt:"",class:"close",onClick:L})]),n("div",Ne,[l(Z,{ref_key:"ruleFormRef",ref:q,model:o,rules:J,"label-width":"120px","label-position":"right"},{default:a(()=>[l(k,null,{default:a(()=>[l(c,{span:12},{default:a(()=>[l(d,{label:"资产编号：",prop:"assetNumber"},{default:a(()=>[l(y,{modelValue:o.assetNumber,"onUpdate:modelValue":t[4]||(t[4]=e=>o.assetNumber=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:a(()=>[l(d,{label:"设备名称：",prop:"name"},{default:a(()=>[l(y,{modelValue:o.name,"onUpdate:modelValue":t[5]||(t[5]=e=>o.name=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(k,null,{default:a(()=>[l(c,{span:12},{default:a(()=>[l(d,{label:"资产应用：",prop:"relate_stcd"},{default:a(()=>[l(f,{modelValue:o.relate_stcd,"onUpdate:modelValue":t[6]||(t[6]=e=>o.relate_stcd=e)},{default:a(()=>[(u(!0),m(b,null,_(P.value,e=>(u(),v(g,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:a(()=>[l(d,{label:"资产类型：",prop:"assetType"},{default:a(()=>[l(f,{modelValue:o.assetType,"onUpdate:modelValue":t[7]||(t[7]=e=>o.assetType=e),onChange:ne},{default:a(()=>[(u(!0),m(b,null,_(h.value,e=>(u(),v(g,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(k,null,{default:a(()=>[l(c,{span:12},{default:a(()=>[l(d,{label:"设备设施类型：",prop:"deviceType"},{default:a(()=>[l(f,{modelValue:o.deviceType,"onUpdate:modelValue":t[8]||(t[8]=e=>o.deviceType=e)},{default:a(()=>[(u(!0),m(b,null,_(A.value,e=>(u(),v(g,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:a(()=>[l(d,{label:"建设时间：",prop:"buildDate"},{default:a(()=>[l(de,{modelValue:o.buildDate,"onUpdate:modelValue":t[9]||(t[9]=e=>o.buildDate=e),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择日期"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(k,null,{default:a(()=>[l(c,{span:12},{default:a(()=>[l(d,{label:"安装位置：",prop:"constructionPoint"},{default:a(()=>[l(y,{modelValue:o.constructionPoint,"onUpdate:modelValue":t[10]||(t[10]=e=>o.constructionPoint=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:a(()=>[l(d,{label:"设备品牌：",prop:"brand"},{default:a(()=>[l(y,{modelValue:o.brand,"onUpdate:modelValue":t[11]||(t[11]=e=>o.brand=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(k,null,{default:a(()=>[l(c,{span:12},{default:a(()=>[l(d,{label:"设备设施状态：",prop:"status"},{default:a(()=>[l(f,{modelValue:o.status,"onUpdate:modelValue":t[12]||(t[12]=e=>o.status=e)},{default:a(()=>[(u(!0),m(b,null,_(O.value,e=>(u(),v(g,{key:e.dictValue,label:e.dictLabel,value:e.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:a(()=>[l(d,{label:"负责人：",prop:"inCharge"},{default:a(()=>[l(y,{modelValue:o.inCharge,"onUpdate:modelValue":t[13]||(t[13]=e=>o.inCharge=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),n("div",{class:"footer"},[n("div",{class:"reset-btn",onClick:L},"取消"),n("div",{class:"search-btn",onClick:le},"确定")])])])):E("",!0),ve(C)?(u(),v(fe,{key:1,data:x.value,style:{width:"60rem"},onCloseRemove:X,onSubRemove:ee},null,8,["data"])):E("",!0)])}}},Fe=pe(Re,[["__scopeId","data-v-9f6a3070"]]);export{Fe as default};
