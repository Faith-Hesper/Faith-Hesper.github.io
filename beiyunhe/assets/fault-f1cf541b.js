import{_ as M,a as U}from"./repair_title_icon-0ac87a57.js";import{b as w}from"./engineeringAPI-b1b8a18c.js";import{b as y,g as D,d as A}from"./unit-ac192840.js";import{_ as Z,f as p,g as N,r as c,o as d,c as m,b as a,w as s,a as o,C as B,F as f,i as v,v as T,d as E,t as F}from"./index-267246aa.js";import"./axios-da025460.js";const j={class:"fault"},O={class:"content"},S={key:0,class:"info"},q={class:"info-item"},J={class:"info-form"},L={class:"info-img report-img"},$=["src"],z={class:"info-item"},G={class:"info-form"},H={class:"info-img repair-img"},K=["src"],x="#5AF76A",P={__name:"fault",setup(Q){let h=JSON.parse(y("equipmentObject")).id;const t=p({reportIdZh:"",reportDate:"",reportMemo:"",reportAttachments:[],step:"",repairerDate:"",repairerIdZh:"",repairMemo:"",repairtAttachments:[]}),_=p([]),g=p([]),k=r=>{const e=A(g.value.filter(n=>n.id===r.id));_.value.forEach(n=>{n.color="",n.id===r.id&&(n.color=x)}),t.value=e[0]};p([{value:"",label:"请选择"},{value:1,label:"完成"},{value:2,label:"维修中"}]);const b=p(!1);return N(()=>{w({deviceid:h}).then(r=>{console.log(r.data),r.data.length&&(b.value=!0,r.data.sort((e,n)=>new Date(e.reportDate).getTime()-new Date(n.reportDate).getTime()),r.data.forEach(e=>{e.reportDate=D(e.reportDate),e.repairerDate=D(e.repairerDate),_.value.push({timestamp:e.reportDate,id:e.id,color:""})}),_.value[0].color=x,t.value=r.data[0],g.value=r.data)})}),(r,e)=>{const n=c("el-timeline-item"),C=c("el-timeline"),u=c("el-input"),i=c("el-form-item"),V=c("el-form");return d(),m("div",j,[a(C,null,{default:s(()=>[(d(!0),m(f,null,v(_.value,(l,I)=>(d(),T(n,{key:I,color:l.color,timestamp:l.timestamp,onClick:R=>k(l)},{default:s(()=>[E(F(l.content),1)]),_:2},1032,["color","timestamp","onClick"]))),128))]),_:1}),o("div",O,[b.value?(d(),m("div",S,[o("div",q,[e[7]||(e[7]=o("div",{class:"info-title"},[o("img",{src:M,class:"img"}),o("span",null,"故障信息")],-1)),o("div",J,[a(V,{model:t.value,disabled:"","label-width":"100px","label-position":"right"},{default:s(()=>[a(i,{label:"报修人员",class:"flex-top"},{default:s(()=>[a(u,{modelValue:t.value.reportIdZh,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.reportIdZh=l)},null,8,["modelValue"])]),_:1}),a(i,{label:"报修时间",class:"flex-top"},{default:s(()=>[a(u,{modelValue:t.value.reportDate,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.reportDate=l)},null,8,["modelValue"])]),_:1}),a(i,{label:"故障描述",class:"flex-top"},{default:s(()=>[a(u,{modelValue:t.value.reportMemo,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.reportMemo=l),type:"textarea"},null,8,["modelValue"])]),_:1}),a(i,{label:"故障图片",class:"flex-top"},{default:s(()=>[o("div",L,[(d(!0),m(f,null,v(t.value.reportAttachments,l=>(d(),m("img",{key:l,src:l,class:"img"},null,8,$))),128))])]),_:1})]),_:1},8,["model"])])]),o("div",z,[e[8]||(e[8]=o("div",{class:"info-title"},[o("img",{src:U,class:"img"}),o("span",null,"维修信息")],-1)),o("div",G,[a(V,{model:t.value,disabled:"","label-width":"100px","label-position":"right"},{default:s(()=>[a(i,{label:"维修状态",class:"flex-top"},{default:s(()=>[a(u,{modelValue:t.value.step,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.step=l)},null,8,["modelValue"])]),_:1}),a(i,{label:"维修时间",class:"flex-top"},{default:s(()=>[a(u,{modelValue:t.value.repairerDate,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.repairerDate=l)},null,8,["modelValue"])]),_:1}),a(i,{label:"维修人员",class:"flex-top"},{default:s(()=>[a(u,{modelValue:t.value.repairerIdZh,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.repairerIdZh=l)},null,8,["modelValue"])]),_:1}),a(i,{label:"维修记录",class:"flex-top"},{default:s(()=>[a(u,{modelValue:t.value.repairMemo,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.repairMemo=l),type:"textarea"},null,8,["modelValue"])]),_:1}),a(i,{label:"维修照片",class:"flex-top"},{default:s(()=>[o("div",H,[(d(!0),m(f,null,v(t.value.repairtAttachments,l=>(d(),m("img",{key:l,src:l,class:"img"},null,8,K))),128))])]),_:1})]),_:1},8,["model"])])])])):B("",!0),e[9]||(e[9]=o("div",{class:"non-data"},"暂无故障维修记录",-1))])])}}},te=Z(P,[["__scopeId","data-v-edc01cba"]]);export{te as default};
