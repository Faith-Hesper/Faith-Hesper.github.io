import{d as K}from"./dialogRemoveCom-ee237155.js";import{H as Q,I as W,D as X}from"./engineeringAPI-21148e34.js";import{_ as E,f as u,g as N,r as i,o as _,v as b,w as r,a as s,b as l,c as R,i as Z,F as ee,x as d,y as oe,A as M,J as le,C as g,d as A,t as P}from"./index-79e36b83.js";import{d as te,a as ae,b as se}from"./dialogFloodAfterSheet-4fd3b089.js";import"./axios-c0524c3b.js";import"./unit-ac192840.js";const ne={class:"period-box"},de={class:"main"},ie={__name:"dialogFloodPeriodSheet",props:{data:Object},emits:["closeSheet","subSheet"],setup(Y,{emit:v}){const S=Y;let m=u(!0);const h=v,n=u({name:"",year:""}),y=u([{value:"汛期检查表",label:"定期汛期检查记录表"}]);function o(){h("closeSheet")}const k=()=>{Q(n.value).then(w=>{M({message:w.msg,type:"success"}),h("subSheet")})};return N(()=>{}),(w,p)=>{const T=i("el-date-picker"),C=i("el-form-item"),q=i("el-option"),V=i("el-select"),B=i("el-form"),D=i("el-dialog");return _(),b(D,{title:S.data.title,top:"17%","modal-class":"sheet-dialog",width:"26%",modelValue:d(m),"onUpdate:modelValue":p[2]||(p[2]=t=>oe(m)?m.value=t:m=t),onClose:o},{default:r(()=>[s("div",ne,[s("div",de,[l(B,{model:n.value,"label-width":"70px","label-position":"right"},{default:r(()=>[l(C,{label:"年份："},{default:r(()=>[l(T,{modelValue:n.value.year,"onUpdate:modelValue":p[0]||(p[0]=t=>n.value.year=t),type:"year","value-format":"YYYY",placeholder:"选择年份"},null,8,["modelValue"])]),_:1}),l(C,{label:"名称："},{default:r(()=>[l(V,{modelValue:n.value.name,"onUpdate:modelValue":p[1]||(p[1]=t=>n.value.name=t),class:"com-select"},{default:r(()=>[(_(!0),R(ee,null,Z(y.value,t=>(_(),b(q,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),s("div",{class:"footer"},[s("div",{class:"reset-btn",onClick:o},"取消"),s("div",{class:"search-btn",onClick:k},"确定")])])]),_:1},8,["title","modelValue"])}}},re=E(ie,[["__scopeId","data-v-8446a56f"]]);const ce={class:"sheet"},ue={class:"top"},_e={class:"search"},me={class:"table"},pe=["onClick"],fe=["onClick"],ve={__name:"floodPeriod",setup(Y){const v=u({date:""});let S=u(!1),m=u(!1),h=u(!1),n=u(!1),y=u(!1),o=le({});const k=u([]),w=()=>{v.value={date:""},f()},p=()=>{f()},T=()=>{o={title:"新增"},m.value=!0},C=e=>{e.title="编辑",o=e,e.xunqiType=="汛前"&&(h.value=!0),e.xunqiType=="汛中"&&(n.value=!0),e.xunqiType=="汛后"&&(y.value=!0)},q=e=>{console.log(e),e.removeText=e.year+": "+(e.xunqiType?e.xunqiType+"检查表":"汛期检查记录表"),o=e,S.value=!0},V=()=>{S.value=!1},B=()=>{m.value=!1},D=()=>{h.value=!1},t=()=>{n.value=!1},U=()=>{y.value=!1},$=()=>{let e="";o.xunqiType?e=o.id:o.children.forEach((c,x)=>{x===o.children.length-1?e+=c.id:e+=c.id+","}),X({formName:"定期汛期检查",ids:e}).then(c=>{console.log(c),M({message:c.msg,type:"success"}),V(),f()})},I=()=>{m.value=!1,f()},O=()=>{h.value=!1,f()},j=()=>{n.value=!1,f()},H=()=>{y.value=!1,f()};N(()=>{f()});const f=()=>{W(v.value).then(e=>{console.log(e),e.data.forEach((c,x)=>{c.id="id"+x}),k.value=e.data})};return(e,c)=>{const x=i("el-date-picker"),J=i("el-form-item"),L=i("el-form"),F=i("el-table-column"),z=i("el-table");return _(),R("div",ce,[s("div",ue,[s("div",_e,[l(L,{model:v.value,inline:""},{default:r(()=>[l(J,{label:"日期"},{default:r(()=>[l(x,{modelValue:v.value.date,"onUpdate:modelValue":c[0]||(c[0]=a=>v.value.date=a),type:"year","value-format":"YYYY-MM-DD",placeholder:"请选择日期"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("div",{class:"search-btn",onClick:p},"查询"),s("div",{class:"reset-btn",onClick:w},"重置")]),s("div",{class:"reset-btn",onClick:T},"新建")]),s("div",me,[l(z,{data:k.value,"default-expand-all":"","row-key":"id",height:"100%"},{default:r(()=>[l(F,{type:"index",width:"70",label:"序号",align:"center"}),l(F,{label:"时间",prop:"year","show-overflow-tooltip":"",align:"center"},{default:r(a=>[A(P(a.row.xunqiType?a.row.xunqiType:a.row.year),1)]),_:1}),l(F,{label:"名称",prop:"xunqiType","show-overflow-tooltip":"",align:"center"},{default:r(a=>[A(P(a.row.xunqiType?a.row.xunqiType+"检查表":"汛期检查记录表"),1)]),_:1}),l(F,{label:"操作",align:"center"},{default:r(a=>[a.row.xunqiType?(_(),R("span",{key:0,class:"oper-span oper-edit",onClick:G=>C(a.row)},"编辑",8,pe)):g("",!0),s("span",{class:"oper-span oper-remove",onClick:G=>q(a.row)},"删除",8,fe)]),_:1})]),_:1},8,["data"])]),d(S)?(_(),b(K,{key:0,data:d(o),onCloseRemove:V,onSubRemove:$},null,8,["data"])):g("",!0),d(m)?(_(),b(re,{key:1,data:d(o),onCloseSheet:B,onSubSheet:I},null,8,["data"])):g("",!0),d(h)?(_(),b(te,{key:2,data:d(o),onCloseSheet:D,onSubSheet:O},null,8,["data"])):g("",!0),d(n)?(_(),b(ae,{key:3,data:d(o),onCloseSheet:t,onSubSheet:j},null,8,["data"])):g("",!0),d(y)?(_(),b(se,{key:4,data:d(o),onCloseSheet:U,onSubSheet:H},null,8,["data"])):g("",!0)])}}},ke=E(ve,[["__scopeId","data-v-d444b68b"]]);export{ke as default};
