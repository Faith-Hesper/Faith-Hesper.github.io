import{_ as L,f as R,s as I,r as i,o as g,v as J,w as a,a as n,t as D,b as t,x as l,u as P,c as x,F as T,i as q,D as A,d as K}from"./index-267246aa.js";import{f as Q,h as W}from"./patrolGuard-eead8834.js";import{u as X}from"./useOperate-2feed5ad.js";import"./axios-da025460.js";import"./index-1899286b.js";const Z={class:"title"},ee={__name:"DetailModal",props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},data:{default:{name:"",content:"",userName:"",time:""}},onSubmit:{default:()=>{}}},emits:["update:visible"],setup(C,{emit:N}){const _=C,m=N,f=R(),y=I(()=>_.visible),u=I(()=>_.data);function v(){m("update:visible",!1)}function V(){f.value.validate(h=>{if(h)_.onSubmit(l(u));else return console.log("error submit!!"),!1})}return(h,s)=>{const b=i("el-input"),c=i("el-form-item"),S=i("el-date-picker"),Y=i("el-form"),k=i("el-dialog");return g(),J(k,{modelValue:y.value,"onUpdate:modelValue":s[4]||(s[4]=r=>y.value=r),"before-close":v,class:"custom-dialog","append-to-body":!0,width:"30%"},{header:a(()=>[n("div",Z,D(C.title),1)]),footer:a(()=>[n("div",{class:"dialog-footer flex content-center"},[n("div",{class:"reset-btn",onClick:v},"取 消"),n("div",{class:"search-btn",type:"primary",onClick:V},"确 定")])]),default:a(()=>[t(Y,{model:u.value,"label-width":"auto","label-position":"left",ref_key:"formRef",ref:f,class:"custom-form"},{default:a(()=>[t(c,{label:"巡查任务名称",prop:"name",required:""},{default:a(()=>[t(b,{class:"custom-input",modelValue:u.value.name,"onUpdate:modelValue":s[0]||(s[0]=r=>u.value.name=r)},null,8,["modelValue"])]),_:1}),t(c,{label:"巡查内容",prop:"content",required:""},{default:a(()=>[t(b,{class:"custom-input",modelValue:u.value.content,"onUpdate:modelValue":s[1]||(s[1]=r=>u.value.content=r)},null,8,["modelValue"])]),_:1}),t(c,{label:"巡查人员",prop:"userName",required:""},{default:a(()=>[t(b,{class:"custom-input",modelValue:u.value.userName,"onUpdate:modelValue":s[2]||(s[2]=r=>u.value.userName=r)},null,8,["modelValue"])]),_:1}),t(c,{label:"巡查日期",prop:"time",required:""},{default:a(()=>[t(S,{type:"date",class:"custom-input","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:u.value.time,"onUpdate:modelValue":s[3]||(s[3]=r=>u.value.time=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},te=L(ee,[["__scopeId","data-v-8d9dde23"]]);const le={class:"header"},oe={class:"right"},ae={class:"title"},ne={class:"num"},se={class:"control"},ie={class:"searchBar-btns"},ue={class:"table"},re={class:"table-page"},de={__name:"view",setup(C){const N={get:Q},{formRef:_,formData:m,dialogVis:f,dialogData:y,tableData:u,onSearch:v,resetForm:V,onSubmit:h,page:s,handleCurrentChange:b,handleSizeChange:c}=X({operationMap:N});new Date().getFullYear().toString(),new Date().getMonth()-1;const S=P(),Y=[{prop:"time",label:"填报时间"},{prop:"name",label:"巡查任务名称"},{prop:"userName",label:"巡查人员"},{prop:"content",label:"巡查点位"}],k=[{title:"待巡查",num:"578",unit:"个"},{title:"逾期未巡查",num:"123",unit:"个"},{title:"已巡查",num:"23",unit:"个"}],r=R(k);function F(d){return{color:""+{待巡查:"#19deff",逾期未巡查:"#ffc002",已巡查:"#19ffa1"}[d]}}function U(d){return["待巡查","已巡查","逾期未巡查"][d]}async function $(){try{const{code:d,data:o}=await W();d===1&&(r.value=k.map(p=>(p.title==="待巡查"&&(p.num=o.toBeNum),p.title==="逾期未巡查"&&(p.num=o.beLateNum),p.title==="已巡查"&&(p.num=o.comNum),p)))}catch(d){console.error("获取数据失败",d)}}$();function H(d){localStorage.setItem("inspectData",JSON.stringify(d)),S.push({path:"/patrolGuard/finishInspect/detail",query:{id:d.id,back:"inspectTask"}})}return(d,o)=>{const p=i("el-date-picker"),M=i("el-form-item"),z=i("el-input"),O=i("el-form"),w=i("el-table-column"),j=i("el-button"),E=i("el-table"),G=i("el-pagination");return g(),x("div",null,[n("div",le,[(g(!0),x(T,null,q(r.value,e=>(g(),x("div",{class:"panel",key:e.title},[n("div",oe,[n("div",ae,D(e.title),1),n("div",ne,D(e.num+e.unit),1)])]))),128))]),n("div",se,[t(O,{inline:!0,model:l(m),"label-width":"auto","label-position":"left",ref_key:"formRef",ref:_,class:"custom-form"},{default:a(()=>[t(M,{label:"日期",prop:"time"},{default:a(()=>[t(p,{style:{width:"185px"},modelValue:l(m).time,"onUpdate:modelValue":o[0]||(o[0]=e=>l(m).time=e),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","popper-class":"custom-select",type:"date"},null,8,["modelValue"])]),_:1}),t(M,{label:"任务名称",prop:"type"},{default:a(()=>[t(z,{class:"custom-input",modelValue:l(m).name,"onUpdate:modelValue":o[1]||(o[1]=e=>l(m).name=e)},null,8,["modelValue"])]),_:1}),t(M,{label:"巡查人员",prop:"userName"},{default:a(()=>[t(z,{class:"custom-input",modelValue:l(m).userName,"onUpdate:modelValue":o[2]||(o[2]=e=>l(m).userName=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),n("div",ie,[n("div",{class:"reset-btn",onClick:o[3]||(o[3]=(...e)=>l(V)&&l(V)(...e))},"重置"),n("div",{class:"search-btn",onClick:o[4]||(o[4]=(...e)=>l(v)&&l(v)(...e))},"查询")])]),n("div",ue,[t(E,{data:l(u),class:"custom-table deep","highlight-current-row":""},{default:a(()=>[t(w,{type:"index",label:"序号",align:"center",width:"70"}),(g(),x(T,null,q(Y,(e,B)=>t(w,{key:B,prop:e.prop,label:e.label,width:e.width,align:"center","show-overflow-tooltip":""},null,8,["prop","label","width"])),64)),t(w,{label:"状态",align:"center",width:"120"},{default:a(e=>[n("div",{class:"tag",style:A(F(U(e.row.status)))},D(U(e.row.status)),5)]),_:1}),t(w,{label:"操作",align:"center",width:"180"},{default:a(e=>[t(j,{type:"primary",text:"primary",onClick:B=>H(e.row),link:""},{default:a(()=>o[6]||(o[6]=[K("详情")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),n("div",re,[t(G,{class:"custom-pagination",onSizeChange:l(c),onCurrentChange:l(b),"current-page":l(s).pageNum,"page-size":l(s).pageSize,layout:"total, prev, pager, next, jumper",total:l(s).total,background:""},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])]),t(te,{visible:l(f),title:"巡查任务",data:l(y),onSubmit:l(h),"onUpdate:visible":o[5]||(o[5]=e=>f.value=e)},null,8,["visible","data","onSubmit"])])}}},ve=L(de,[["__scopeId","data-v-2722a3f5"]]);export{ve as default};
